<?xml version="1.0" encoding="UTF-8"?>
<AnyLogicWorkspace WorkspaceVersion="1.8" AnyLogicVersion="5.5.0.779">
<Projects>
<Item Name="AIIS" Expanded="y" AdditionalLibraries="jbcl.jar;dx.jar;beandt.jar" FolderForGeneratedFiles="C:\srcAnylogic\">
<Compatibility GenerateGetThis="n" DontGenerateToString="n" DontGenerateClone="n" GenerateGetOwnerForTimer="n"/>
<OCLOptions/>
<HLA/>
<Packages>
<Item Name="aiis" Expanded="y">
<ActiveObjectClasses>
<Item Name="GPRS" Expanded="y">
<AdditionalClassCode><![CDATA[
Vector VrOprosaGPRS = new Vector();
Vector avTimeSET = new Vector();
Vector avTimeMIR = new Vector();

boolean AllCounter = false;
boolean transferOk,repeatFrame,estSlot,netSlot = false;
double log10(double x)
{
 double y = (Math.log(x))/(Math.log(10));
 return y;
}
double HataModel()
{
 double Ahr = (1.1*log10(f)-0.7)*Hr-(1.56*log10(f)-0.8);
 Lg = 69.55+26.16*log10(f)-13.82*log10(Ht)-Ahr+(44.9-6.55*log10(Ht))*log10(distance);
 Lpr = Lg-2*((log10(f/28))*(log10(f/28)))-5.4;
 Ls = Lg - 4.78*(log10(f))*(log10(f))+17.33*log10(f)-40.94;
 Pr = powerBS+gainBS-Ls+gainMS;
 noise = DistrUniform.sample(-150,-100);
 double CI=Pr-noise;
 return CI;
 }

double modelErlang(double n)
{ 
  double res=0;
  double sum=0;
  long j=1;
  for (int i=1;i<=(n);i++)
    {
     j=j*i;
     sum=sum+Math.pow(A,i)/j;
    }
  res=(Math.pow(A,n)/j)/(sum);
  return res;   
}

int getKolSlotUP(double j){
int i=1;
if (maxKolSlotUP==1)
{
 i=1;
} 
else if (maxKolSlotUP==2)
{
  if ( j > 0.5 & j <=0.99)
      {i=1;}
   else if (j >=0 & j <= 0.5)
      {i=2;} 
}
else if (maxKolSlotUP==3)
{
  if ( j > 0.6 & j <=0.99)
      {i=1;}
  else if (j >=0.6 & j < 0.3)
      {i=2;} 
  else if (j >=0 & j <= 0.3)
      {i=3;} 
}
 
return i;
}

int getKolSlotDOWN(double j){
int i=1;
if (maxKolSlotDOWN==1)
{
 i=1;
} 
else if (maxKolSlotDOWN==2)
{
  if ( j > 0.5 & j <=0.99)
      {i=1;}
   else if (j >=0 & j <= 0.5)
      {i=2;} 
}
else if (maxKolSlotDOWN==3)
{
  if ( j > 0.6 & j <=0.99)
      {i=1;}
  else if (j >=0.6 & j < 0.3)
      {i=2;} 
  else if (j >=0 & j <= 0.3)
      {i=3;} 
}
 else if (maxKolSlotDOWN==4)
{
  if ( j > 0.75 & j <=0.99)
      {i=1;}
  else if (j >0.5 & j <= 0.75)
      {i=2;} 
  else if (j >0.25 & j <= 0.5)
      {i=3;} 
  else if (j >=0 & j <= 0.25)
      {i=4;} 
}
return i;
}











]]></AdditionalClassCode>
<ConversionTables>
<Item Name="CS1" TransformationType="1" ArgOutOfRangeReactionType="1">
<RecordList>
<Record Arg="0" Fun="0.5"/>
<Record Arg="2" Fun="0.5"/>
<Record Arg="4" Fun="0.3"/>
<Record Arg="6" Fun="0.15"/>
<Record Arg="8" Fun="0.04"/>
<Record Arg="10" Fun="0.015"/>
<Record Arg="12" Fun="0.004"/>
<Record Arg="14" Fun="0.001"/>
<Record Arg="16" Fun="0.0005"/>
<Record Arg="18" Fun="0.00001"/>
<Record Arg="20" Fun="0.000005"/>
<Record Arg="22" Fun="0.0000001"/>
<Record Arg="22" Fun="0.0000001"/>
</RecordList></Item>
<Item Name="CS1throughput" TransformationType="1" ArgOutOfRangeReactionType="1">
<RecordList>
<Record Arg="0" Fun="100"/>
<Record Arg="0" Fun="100"/>
<Record Arg="3" Fun="3000"/>
<Record Arg="7" Fun="6500"/>
<Record Arg="11" Fun="8400"/>
<Record Arg="15" Fun="9000"/>
<Record Arg="19" Fun="9050"/>
<Record Arg="23" Fun="9050"/>
<Record Arg="27" Fun="9050"/>
<Record Arg="27" Fun="9050"/>
</RecordList></Item>
<Item Name="CS2" TransformationType="1" ArgOutOfRangeReactionType="1">
<RecordList>
<Record Arg="0" Fun="0.8"/>
<Record Arg="2" Fun="0.8"/>
<Record Arg="4" Fun="0.65"/>
<Record Arg="6" Fun="0.45"/>
<Record Arg="8" Fun="0.25"/>
<Record Arg="10" Fun="0.12"/>
<Record Arg="12" Fun="0.05"/>
<Record Arg="14" Fun="0.01"/>
<Record Arg="16" Fun="0.0065"/>
<Record Arg="18" Fun="0.0025"/>
<Record Arg="20" Fun="0.00001"/>
<Record Arg="22" Fun="0.000005"/>
<Record Arg="22" Fun="0.000005"/>
</RecordList></Item>
<Item Name="CS2throughput" TransformationType="1" ArgOutOfRangeReactionType="1">
<RecordList>
<Record Arg="0" Fun="100"/>
<Record Arg="0" Fun="100"/>
<Record Arg="3" Fun="2000"/>
<Record Arg="7" Fun="6700"/>
<Record Arg="11" Fun="11000"/>
<Record Arg="15" Fun="12800"/>
<Record Arg="19" Fun="13400"/>
<Record Arg="23" Fun="13400"/>
<Record Arg="27" Fun="13400"/>
<Record Arg="27" Fun="13400"/>
</RecordList></Item>
<Item Name="CS3" TransformationType="1" ArgOutOfRangeReactionType="1">
<RecordList>
<Record Arg="0" Fun="0.9"/>
<Record Arg="2" Fun="0.9"/>
<Record Arg="4" Fun="0.8"/>
<Record Arg="6" Fun="0.65"/>
<Record Arg="8" Fun="0.45"/>
<Record Arg="10" Fun="0.25"/>
<Record Arg="12" Fun="0.13"/>
<Record Arg="14" Fun="0.055"/>
<Record Arg="16" Fun="0.02"/>
<Record Arg="18" Fun="0.006"/>
<Record Arg="20" Fun="0.0015"/>
<Record Arg="22" Fun="0.00001"/>
<Record Arg="22" Fun="0.00001"/>
</RecordList></Item>
<Item Name="CS3throughput" TransformationType="1" ArgOutOfRangeReactionType="1">
<RecordList>
<Record Arg="0" Fun="100"/>
<Record Arg="0" Fun="100"/>
<Record Arg="3" Fun="1000"/>
<Record Arg="7" Fun="4000"/>
<Record Arg="11" Fun="10000"/>
<Record Arg="15" Fun="13800"/>
<Record Arg="19" Fun="15100"/>
<Record Arg="23" Fun="15600"/>
<Record Arg="27" Fun="15600"/>
<Record Arg="27" Fun="15600"/>
</RecordList></Item>
<Item Name="CS4" TransformationType="1" ArgOutOfRangeReactionType="1">
<RecordList>
<Record Arg="0" Fun="1"/>
<Record Arg="0" Fun="1"/>
<Record Arg="2" Fun="1"/>
<Record Arg="4" Fun="0.99"/>
<Record Arg="6" Fun="0.98"/>
<Record Arg="8" Fun="0.9"/>
<Record Arg="10" Fun="0.8"/>
<Record Arg="12" Fun="0.65"/>
<Record Arg="14" Fun="0.5"/>
<Record Arg="16" Fun="0.35"/>
<Record Arg="18" Fun="0.22"/>
<Record Arg="20" Fun="0.14"/>
<Record Arg="22" Fun="0.08"/>
<Record Arg="22" Fun="0.08"/>
</RecordList></Item>
<Item Name="CS4throughput" TransformationType="1" ArgOutOfRangeReactionType="1">
<RecordList>
<Record Arg="0" Fun="100"/>
<Record Arg="0" Fun="100"/>
<Record Arg="3" Fun="500"/>
<Record Arg="7" Fun="1500"/>
<Record Arg="11" Fun="5800"/>
<Record Arg="15" Fun="11000"/>
<Record Arg="19" Fun="15500"/>
<Record Arg="23" Fun="18000"/>
<Record Arg="27" Fun="19000"/>
<Record Arg="27" Fun="19000"/>
</RecordList></Item>
</ConversionTables>
<StructureDiagram>
<Variable ID="67" Name="minMS" Pos="120 210" NamePos="130 210">
<VarType ScalarType="real"/>
<Value><![CDATA[1]]></Value>
<Equation/></Variable>
<Variable ID="66" Name="maxMS" Pos="50 290" NamePos="60 290">
<VarType ScalarType="real"/>
<Value><![CDATA[1]]></Value>
<Equation/></Variable>
<Variable ID="50" Name="Ls" Pos="30 480" NamePos="40 480">
<VarType ScalarType="real"/>
<Value><![CDATA[
0

]]></Value>
<Equation/></Variable>
<Variable ID="51" Name="noise" Pos="90 460" NamePos="100 460">
<VarType ScalarType="real"/>
<Value><![CDATA[0]]></Value>
<Equation/></Variable>
<Variable ID="52" Name="Pr" Pos="90 440" NamePos="100 440">
<VarType ScalarType="real"/>
<Value><![CDATA[0]]></Value>
<Equation/></Variable>
<Variable ID="53" Name="Lpr" Pos="30 460" NamePos="40 460">
<VarType ScalarType="real"/>
<Value><![CDATA[
0

]]></Value>
<Equation/></Variable>
<Variable ID="54" Name="Lg" Pos="30 440" NamePos="40 440">
<VarType ScalarType="real"/>
<Value><![CDATA[
0

]]></Value>
<Equation/></Variable>
<Variable ID="55" Name="distance" Pos="120 390" NamePos="130 390">
<VarType ScalarType="real"/>
<Value><![CDATA[0]]></Value>
<Equation/></Variable>
<Variable ID="56" Name="f" Pos="120 370" NamePos="130 370">
<VarType ScalarType="real"/>
<Value><![CDATA[
930

]]></Value>
<Equation/></Variable>
<Variable ID="57" Name="gainMS" Pos="30 410" NamePos="40 410">
<VarType ScalarType="real"/>
<Value><![CDATA[0]]></Value>
<Equation/></Variable>
<Variable ID="58" Name="gainBS" Pos="30 390" NamePos="40 390">
<VarType ScalarType="real"/>
<Value><![CDATA[0]]></Value>
<Equation/></Variable>
<Variable ID="59" Name="powerBS" Pos="30 370" NamePos="40 370">
<VarType ScalarType="real"/>
<Value><![CDATA[0]]></Value>
<Equation/></Variable>
<Variable ID="60" Name="Hr" Pos="120 350" NamePos="130 350">
<VarType ScalarType="real"/>
<Value><![CDATA[
0

]]></Value>
<Equation/></Variable>
<Variable ID="61" Name="Ht" Pos="30 350" NamePos="40 350">
<VarType ScalarType="real"/>
<Value><![CDATA[
0


]]></Value>
<Equation/></Variable>
<Variable ID="63" Name="SNR" Pos="90 480" NamePos="100 480">
<VarType ScalarType="real" Rows="1" Columns="5"/>
<Value><![CDATA[0]]></Value>
<Equation RightHandSide="DistrUniform.sample(50,55)"/></Variable>
<Variable ID="47" Name="timeTransferI" Pos="260 440" NamePos="270 440">
<VarType ScalarType="real"/>
<Value><![CDATA[0]]></Value>
<Equation/></Variable>
<Variable ID="45" Name="timeScale" Pos="260 110" NamePos="270 109.9">
<VarType ScalarType="real"/>
<Value><![CDATA[60]]></Value>
<Equation/></Variable>
<Variable ID="43" Name="timeOutFromMIR" Pos="30 160" NamePos="40 160">
<VarType ScalarType="real"/>
<Value><![CDATA[
0

]]></Value>
<Equation/></Variable>
<Variable ID="42" Name="timeOutFromSET" Pos="30 140" NamePos="40 140">
<VarType ScalarType="real"/>
<Value><![CDATA[
0

]]></Value>
<Equation/></Variable>
<Variable ID="41" Name="verRepeat" Pos="260 190" NamePos="270 190">
<VarType ScalarType="real"/>
<Value><![CDATA[0]]></Value>
<Equation/></Variable>
<Variable ID="40" Name="kolSlotDOWN" Pos="260 170" NamePos="270 170">
<VarType ScalarType="integer"/>
<Value><![CDATA[0]]></Value>
<Equation/></Variable>
<Variable ID="39" Name="transferCondition" Pos="30 120" NamePos="40 120">
<VarType ScalarType="integer"/>
<Value><![CDATA[0]]></Value>
<Equation/></Variable>
<Variable ID="38" Name="currentTimeOpros" Pos="260 420" NamePos="270 420">
<VarType ScalarType="real"/>
<Value><![CDATA[0]]></Value>
<Equation/></Variable>
<Variable ID="35" Name="currentCounter" Pos="30 80" NamePos="40 80">
<VarType ScalarType="integer"/>
<Value><![CDATA[0]]></Value>
<Equation/></Variable>
<Variable ID="34" Name="timeWait" Pos="260 400" NamePos="270 400">
<VarType ScalarType="real"/>
<Value><![CDATA[0]]></Value>
<Equation/></Variable>
<Variable ID="32" Name="bitrate" Pos="260 230" NamePos="270 230">
<VarType ScalarType="real"/>
<Value><![CDATA[0]]></Value>
<Equation/></Variable>
<Variable ID="31" Name="kolData" Pos="260 360" NamePos="270 360">
<VarType ScalarType="real"/>
<Value><![CDATA[0]]></Value>
<Equation/></Variable>
<Variable ID="30" Name="kolRepeat" Pos="260 340" NamePos="270 340">
<VarType ScalarType="integer"/>
<Value><![CDATA[0]]></Value>
<Equation/></Variable>
<Variable ID="29" Name="bitrateForSlot" Pos="260 210" NamePos="270 210">
<VarType ScalarType="real"/>
<Value><![CDATA[
9600

]]></Value>
<Equation/></Variable>
<Variable ID="28" Name="transferData" Pos="260 380" NamePos="270 380">
<VarType ScalarType="real"/>
<Value><![CDATA[0]]></Value>
<Equation/></Variable>
<Variable ID="27" Name="kolSlotUP" Pos="260 150" NamePos="270 150">
<VarType ScalarType="integer"/>
<Value><![CDATA[0]]></Value>
<Equation/></Variable>
<Variable ID="24" Name="kolBlok" Pos="260 320" NamePos="270 320">
<VarType ScalarType="integer"/>
<Value><![CDATA[0]]></Value>
<Equation/></Variable>
<Variable ID="22" Name="currentVer" Pos="120 290" NamePos="130 290">
<VarType ScalarType="real"/>
<Value><![CDATA[
0

]]></Value>
<Equation/></Variable>
<Variable ID="14" Name="verBlok" Pos="120 270" NamePos="130 270">
<VarType ScalarType="real"/>
<Value><![CDATA[0]]></Value>
<Equation Type="1" RightHandSide="modelErlang(kolChannelBS)"/></Variable>
<Variable ID="15" Name="kolChannelBS" Pos="120 250" NamePos="130 250">
<VarType ScalarType="real"/>
<Value><![CDATA[
0

]]></Value>
<Equation RightHandSide="FCh*8"/></Variable>
<Variable ID="16" Name="kolMS" Pos="50 270" NamePos="60 270">
<VarType ScalarType="real"/>
<Value><![CDATA[


]]></Value>
<Equation Type="1" RightHandSide="Math.round(DistrUniform.sample(minMS,maxMS))"/></Variable>
<Variable ID="17" Name="A" Pos="50 250" NamePos="60 250">
<VarType ScalarType="real"/>
<Equation Type="1" RightHandSide="(kolMS*intZayavok*timeObs)/3600"/></Variable>
<Variable ID="18" Name="timeObs" Pos="50 230" NamePos="60 230">
<VarType ScalarType="real"/>
<Equation Type="1" RightHandSide="DistrExponential.sample(180)"/></Variable>
<Variable ID="19" Name="intZayavok" Pos="120 230" NamePos="130 230">
<VarType ScalarType="real"/>
<Equation Type="1" RightHandSide="DistrPoisson.sample(3)"/></Variable>
<Variable ID="13" Name="statusFER" Pos="30 100" NamePos="40 100">
<VarType ScalarType="boolean"/>
<Value><![CDATA[false]]></Value>
<Equation/></Variable>
<Variable ID="9" Name="ID" Pos="260 90" NamePos="270 90">
<VarType ScalarType="integer"/>
<Value><![CDATA[0]]></Value>
<Equation/></Variable>
<Statechart ID="4" Name="GPRS" Pos="180 20" NamePos="190 20">
<Items>
<Initial ID="4" Name="pointer" Target="30" Points="-20 -210 -20 -180"/>
<ChoicePoint ID="58" Name="branch1" Pos="-90 -130" InCables="66 41" OutCables="62 61">
<Action><![CDATA[
currentVer =Math.round(verBlok*100);
if (currentVer > 0)
{
 if (randomTrue(currentVer/100))
    { netSlot=true;}
 else
    {kolSlotUP=getKolSlotUP(currentVer/100);
     kolSlotDOWN=getKolSlotDOWN(currentVer/100);
     estSlot=true;}
}
else
{kolSlotUP=getKolSlotUP(currentVer/100);
kolSlotDOWN=getKolSlotDOWN(currentVer/100);
estSlot=true;}


]]></Action></ChoicePoint>
<ChoicePoint ID="50" Name="branch" Pos="-80 210" InCables="75" OutCables="56 53">
<Action><![CDATA[
if (verRepeat<=0)
{statusFER=false;}
else if (verRepeat>=1)
{statusFER=true;}
else
{statusFER=randomTrue(verRepeat);}

if (statusFER)
{
repeatFrame=true;
}
else if (statusFER==false)
{
transferOk=true;
}
]]></Action></ChoicePoint>
<Transition ID="77" Name="transition14" Source="76" Target="74" Points="-80 140 -80 160" Type="1"/>
<Transition ID="75" Name="transition13" Source="74" Target="50" Points="-80 180 -80 199.5" Type="1">
<Trigger><![CDATA["nextStep"]]></Trigger></Transition>
<Transition ID="71" Name="transition12" Source="73" Target="72" Points="-80 -20 -80 0" Type="1">
<Trigger><![CDATA["nextStep"]]></Trigger></Transition>
<Transition ID="69" Name="transition10" Source="72" Target="48" Points="-80 20 -80 40" Type="1"/>
<Transition ID="68" Name="transition9" Source="59" Target="73" Points="-160 -70 -160 -60 -80 -60 -80 -40" Type="1"/>
<Transition ID="66" Name="transition6" Source="63" Target="58" Points="-60 -130 -79.5 -130" Type="1"/>
<Transition ID="65" Name="transition5" Source="60" Target="63" Points="20 -80 30 -80 30 -130 10 -130" Type="1">
<Trigger><![CDATA[1/timeScale]]></Trigger></Transition>
<Transition ID="62" Name="transition1" Source="58" Target="60" Points="-80.9 -124.8 -20 -90" Type="1">
<Guard><![CDATA[netSlot]]></Guard></Transition>
<Transition ID="61" Name="transition" Source="58" Target="59" Points="-99.1 -124.8 -160 -90" Type="1">
<Guard><![CDATA[estSlot]]></Guard></Transition>
<Transition ID="57" Name="transition8" Source="55" Target="30" Points="-40 250 140 250 140 -160" Type="1">
<Trigger><![CDATA["nextStep"]]></Trigger>
<Action><![CDATA[
model m = (model)getOwner();
for(int i=0;i<(m.parKolMasGPRS.size()/2);i++)
{
 if (ID==i)
   {
    if (currentCounter==1)
    {
     
       if (timeTransferI>=20)
           {
           m.sETGPRS.item(i).openCloseChannel = false;
           m.sETGPRS.item(i).oprosAlgoritm.fireEvent("receiveData");
           m.sETGPRS.item(i).avTimeSETGPRS=m.sETGPRS.item(i).avTimeSETGPRS+timeTransferI;
           m.gPRS.item(i).timeTransferI=0;
           }
         else 
           {
           m.sETGPRS.item(i).oprosAlgoritm.fireEvent("receiveData");
          m.sETGPRS.item(i).avTimeSETGPRS=m.sETGPRS.item(i).avTimeSETGPRS+timeTransferI;
           m.gPRS.item(i).timeTransferI=0;
           }
     }
    else if (currentCounter==2)
    {
     m.mIRGPRS.item(i).avTimeMIRGPRS=m.mIRGPRS.item(i).avTimeMIRGPRS+timeTransferI;
     m.mIRGPRS.item(i).oprosAlgoritm.fireEvent("receiveData");
     m.gPRS.item(i).timeTransferI=0;
    }
   }
}
]]></Action></Transition>
<Transition ID="56" Name="transition7" Source="50" Target="55" Points="-90.5 210 -180 210 -180 240" Type="1">
<Guard><![CDATA[repeatFrame]]></Guard>
<Action><![CDATA[repeatFrame=false;]]></Action></Transition>
<Transition ID="53" Name="transition3" Source="50" Target="30" Points="-69.5 210 100 210 100 -160" Type="1">
<Guard><![CDATA[transferOk]]></Guard>
<Action><![CDATA[
transferOk=false;
model m = (model)getOwner();
for(int i=0;i<(m.parKolMasGPRS.size()/2);i++)
{
 if (ID==i)
   {
    if (currentCounter==1)
    {
     
         if (timeTransferI>=20)
           {
           m.sETGPRS.item(i).openCloseChannel = false;
           m.sETGPRS.item(i).oprosAlgoritm.fireEvent("receiveData");
           m.sETGPRS.item(i).avTimeSETGPRS=m.sETGPRS.item(i).avTimeSETGPRS+timeTransferI;
           m.gPRS.item(i).timeTransferI=0;
           }
         else 
           {
           m.sETGPRS.item(i).oprosAlgoritm.fireEvent("receiveData");
           m.sETGPRS.item(i).avTimeSETGPRS=m.sETGPRS.item(i).avTimeSETGPRS+timeTransferI;
           m.gPRS.item(i).timeTransferI=0;
           }
    }
    else if (currentCounter==2)
    {
     m.mIRGPRS.item(i).avTimeMIRGPRS=m.mIRGPRS.item(i).avTimeMIRGPRS+timeTransferI;
     m.mIRGPRS.item(i).oprosAlgoritm.fireEvent("receiveData");
      m.gPRS.item(i).timeTransferI=0;
    }
   }
}
]]></Action></Transition>
<Transition ID="52" Name="transition2" Source="42" Target="76" Points="-80 100 -80 120" Type="1">
<Trigger><![CDATA["nextStep"]]></Trigger></Transition>
<Transition ID="49" Name="transition11" Source="48" Target="42" Points="-80 60 -80 80" Type="1">
<Trigger><![CDATA["nextStep"]]></Trigger></Transition>
<Transition ID="41" Name="transition4" Source="30" Target="58" Points="-90 -160 -90 -140.5" Type="4">
<Trigger><![CDATA["sendData"]]></Trigger></Transition>
<State ID="76" Name="Сетевые задержки" Rect="-200 120 40 140" NamePos="-140 120" InCables="52" OutCables="77">
<EntryAction><![CDATA[
double netDelay = DistrNormal.sample(0.3,0.7);
if (netDelay<0.1)
{netDelay=0.1;}
currentTimeOpros=currentTimeOpros+netDelay;
timeTransferI=timeTransferI+netDelay;
]]></EntryAction></State>
<State ID="74" Name="Задержка сборки данных" Rect="-200 160 40 180" NamePos="-160 160" InCables="77" OutCables="75">
<EntryAction><![CDATA[
currentTimeOpros=currentTimeOpros+0.25;
timeTransferI=timeTransferI+0.25;
]]></EntryAction></State>
<State ID="73" Name="Кодирование данных" Rect="-200 -40 40 -20" NamePos="-150 -40" InCables="68" OutCables="71">
<EntryAction><![CDATA[
if (currentCounter==1)
    {
     currentTimeOpros=currentTimeOpros+timeOutFromSET;
     timeTransferI=timeTransferI+timeOutFromSET;
    }
else if (currentCounter==2)
    {
     currentTimeOpros=currentTimeOpros+timeOutFromMIR;
      timeTransferI=timeTransferI+timeOutFromMIR;
    }
 double timeCode;
timeCode=0.08;
currentTimeOpros=currentTimeOpros+timeCode;
timeTransferI=timeTransferI+timeCode;
]]></EntryAction></State>
<State ID="72" Name="Формирование пакетов" Rect="-200 0 40 20" NamePos="-150 0" InCables="71" OutCables="69">
<EntryAction><![CDATA[
 double timePacket;
timePacket=0.025;
currentTimeOpros=currentTimeOpros+timePacket;
timeTransferI=timeTransferI+timePacket;
]]></EntryAction></State>
<State ID="63" Name="Ожидание" Rect="-60 -140 10 -120" NamePos="-60 -140" InCables="65" OutCables="66">
<EntryAction><![CDATA[timeWait=timeWait+1;]]></EntryAction></State>
<State ID="60" Name="Нет слота" Rect="-70 -90 20 -70" NamePos="-60 -90" InCables="62" OutCables="65">
<ExitAction><![CDATA[
netSlot=false;
kolBlok++;
]]></ExitAction></State>
<State ID="59" Name="Есть слоты" Rect="-200 -90 -110 -70" NamePos="-190 -90" InCables="61" OutCables="68">
<EntryAction><![CDATA[
SNR = HataModel();
if (typeCS==1)
{
 verRepeat=CS1(SNR);
 bitrateForSlot=CS1throughput(SNR);
}
else if (typeCS==2)
{
 verRepeat=CS2(SNR);
 bitrateForSlot=CS2throughput(SNR);
}
else if (typeCS==3)
{
 verRepeat=CS3(SNR);
 bitrateForSlot=CS3throughput(SNR);
}
else if (typeCS==4)
{
 verRepeat=CS4(SNR);
 bitrateForSlot=CS4throughput(SNR);
}
currentTimeOpros=currentTimeOpros+timeWait;
timeTransferI=timeTransferI+timeWait;
timeWait=0;
]]></EntryAction>
<ExitAction><![CDATA[estSlot=false;]]></ExitAction></State>
<State ID="30" Name="Ожидание данных на передачу" Rect="-200 -180 170 -160" NamePos="-120 -180" InCables="4 57 53" OutCables="41">
<EntryAction><![CDATA[
model m = (model)getOwner();

]]></EntryAction></State>
<State ID="42" Name="Передача данных" Rect="-200 80 40 100" NamePos="-130 80" InCables="49" OutCables="52">
<EntryAction><![CDATA[
if (transferCondition==1)
{
 bitrate=bitrateForSlot*kolSlotDOWN;
}
else if  (transferCondition==2)
{
 bitrate=bitrateForSlot*kolSlotUP;
}
currentTimeOpros=currentTimeOpros+(transferData/bitrate);
kolData=kolData+transferData;
timeTransferI=timeTransferI+(transferData/bitrate);
]]></EntryAction></State>
<State ID="48" Name="Время распространения сигнала" Rect="-200 40 40 60" NamePos="-180 40" InCables="69" OutCables="49">
<EntryAction><![CDATA[
currentTimeOpros=currentTimeOpros+timeWave;
timeTransferI=timeTransferI+timeWave;
]]></EntryAction></State>
<State ID="55" Name="Повтор передачи блока" Rect="-200 240 -40 260" NamePos="-190 240" InCables="56" OutCables="57">
<EntryAction><![CDATA[
kolData=kolData+transferData;
timeTransferI=timeTransferI+((transferData/bitrate)+(uniform(0.1,1))+timeWave+0.25+0.25);
currentTimeOpros=currentTimeOpros+((transferData/bitrate)+(uniform(0.1,1))+timeWave+0.25+0.25);
]]></EntryAction>
<ExitAction><![CDATA[kolRepeat++;]]></ExitAction></State>
</Items></Statechart>
<Port ID="3" Name="portOut" Pos="400 250" Parent="1"/>
<Port ID="2" Name="portIn" Pos="-10 250" Parent="1"/>
<Bounds Flags="0" Pen="#808080 20" Brush="#000000" ID="1" Name="GPRS" Rect="-10 0 400 500" NamePos="0 10" Children="3 2"/>
<Comment ID="64" Name="textBox6" Rect="10 310 230 490">
<Text><![CDATA[Модель Хаты-распр. сигнала]]></Text></Comment>
<Comment ID="49" Name="textBox5" Rect="240 40 380 240">
<Text><![CDATA[Системные переменные]]></Text></Comment>
<Comment ID="48" Name="textBox4" Rect="10 40 230 170">
<Text><![CDATA[Вспомогательные переменные]]></Text></Comment>
<Comment ID="25" Name="textBox1" Rect="240 260 380 490">
<Text><![CDATA[
Собираемая статистика


]]></Text></Comment>
<Comment ID="20" Name="textBox" Rect="10 180 230 300">
<Text><![CDATA[
Модель Эрланга-вероятность блокировки

]]></Text></Comment>
<Comment ID="10" Name="textBox2" Rect="480 10 1050 310">
<Text><![CDATA[Общая задержка в канале GSM при распространении в прямом и обратном направлениях, вызванная обработкой сигнала, кодированием/декодированием речи, канальным кодированием и т.д., составляет около 180 мс.]]></Text></Comment>
</StructureDiagram><Image/>
<Parameters>
<Item Name="timeWave" DefaultValue="0.002" Modificator="2"/>
<Item Name="maxKolSlotUP" DefaultValue="0" Modificator="2"/>
<Item Name="typeCS" Type="integer" DefaultValue="0" Modificator="2"/>
<Item Name="maxKolSlotDOWN" DefaultValue="0" Modificator="2"/>
</Parameters>
<IconDiagram>
<Port ID="1" Name="portOut" Pos="30 0" PrototypeID="3"/>
<Port ID="2" Name="portIn" Pos="-30 0" PrototypeID="2"/>
<Text ID="5" Name="text" Rect="-18 -9 15.5 7.4" Flags="28680" Pen="no 0" Brush="#000000" Font="Tahoma,12">
<Text><![CDATA[GPRS]]></Text></Text>
<Rectangle Pen="#f5912d 10" Brush="#f7aa5e" ID="3" Name="rectangle" Rect="-30 -20 30 20"/>
<Rectangle Pen="no 0" Brush="#c0c0c0" ID="4" Rect="-27.5 -17.5 32.5 22.5"/>
</IconDiagram></Item>
<Item Name="GSM" Expanded="y">
<AdditionalClassCode><![CDATA[
Vector VrOprosaGSM = new Vector();
Vector avTimeSET = new Vector();
Vector avTimeMIR = new Vector(); 

Vector vrUst = new Vector();
Vector vrEnd = new Vector();  

boolean connect,disconnect = false;
boolean AllCounter,oprosSET,oprosMIR = false;
boolean repeatFrame,transferOk = false; 

double log10(double x)
{
 double y = (Math.log(x))/(Math.log(10));
 return y;
}
double HataModel()
{
 double Ahr = (1.1*log10(f)-0.7)*Hr-(1.56*log10(f)-0.8);
 Lg = 69.55+26.16*log10(f)-13.82*log10(Ht)-Ahr+(44.9-6.55*log10(Ht))*log10(distance);
 Lpr = Lg-2*((log10(f/28))*(log10(f/28)))-5.4;
 Ls = Lg - 4.78*(log10(f))*(log10(f))+17.33*log10(f)-40.94;
 Pr = powerBS+gainBS-Ls+gainMS;
 noise = DistrUniform.sample(-150,-100);
 SNR=Pr-noise;
 if (SNR<0)
 {BER=0.5;}
 else
 {BER = 1/(2+SNR);}
 return BER;
}


]]></AdditionalClassCode>
<ConversionTables>
<Item Name="CSthroughput" TransformationType="2" ArgOutOfRangeReactionType="1">
<RecordList>
<Record Arg="3" Fun="1500"/>
<Record Arg="6" Fun="4500"/>
<Record Arg="8" Fun="8000"/>
<Record Arg="11" Fun="9600"/>
<Record Arg="16" Fun="9600"/>
<Record Arg="20" Fun="9600"/>
</RecordList></Item>
</ConversionTables>
<StructureDiagram>
<Variable ID="80" Name="timeoutALL" Pos="210 390" NamePos="220 390">
<VarType ScalarType="real"/>
<Value><![CDATA[0.18]]></Value>
<Equation/></Variable>
<Variable ID="79" Name="help" Pos="180 330" NamePos="190 330">
<VarType ScalarType="real"/>
<Equation Type="1" RightHandSide="0"/></Variable>
<Variable ID="76" Name="Ls" Pos="80 420" NamePos="90 420">
<VarType ScalarType="real"/>
<Value><![CDATA[
0

]]></Value>
<Equation/></Variable>
<Variable ID="75" Name="noise" Pos="140 400" NamePos="150 400">
<VarType ScalarType="real"/>
<Value><![CDATA[0]]></Value>
<Equation/></Variable>
<Variable ID="74" Name="Pr" Pos="140 380" NamePos="150 380">
<VarType ScalarType="real"/>
<Value><![CDATA[0]]></Value>
<Equation/></Variable>
<Variable ID="73" Name="Lpr" Pos="80 400" NamePos="90 400">
<VarType ScalarType="real"/>
<Value><![CDATA[
0

]]></Value>
<Equation/></Variable>
<Variable ID="72" Name="Lg" Pos="80 380" NamePos="90 380">
<VarType ScalarType="real"/>
<Value><![CDATA[
0

]]></Value>
<Equation/></Variable>
<Variable ID="71" Name="distance" Pos="80 350" NamePos="90 350">
<VarType ScalarType="real"/>
<Value><![CDATA[0]]></Value>
<Equation/></Variable>
<Variable ID="70" Name="f" Pos="170 290" NamePos="180 290">
<VarType ScalarType="real"/>
<Value><![CDATA[
930

]]></Value>
<Equation/></Variable>
<Variable ID="69" Name="gainMS" Pos="80 330" NamePos="90 330">
<VarType ScalarType="real"/>
<Value><![CDATA[0]]></Value>
<Equation/></Variable>
<Variable ID="68" Name="gainBS" Pos="80 310" NamePos="90 310">
<VarType ScalarType="real"/>
<Value><![CDATA[0]]></Value>
<Equation/></Variable>
<Variable ID="67" Name="powerBS" Pos="80 290" NamePos="90 290">
<VarType ScalarType="real"/>
<Value><![CDATA[0]]></Value>
<Equation/></Variable>
<Variable ID="66" Name="Hr" Pos="170 270" NamePos="180 270">
<VarType ScalarType="real"/>
<Value><![CDATA[
0

]]></Value>
<Equation/></Variable>
<Variable ID="65" Name="Ht" Pos="130 270" NamePos="140 270">
<VarType ScalarType="real"/>
<Value><![CDATA[
0


]]></Value>
<Equation/></Variable>
<Variable ID="59" Name="kolNeudach" Pos="-100 370" NamePos="-90 370">
<VarType ScalarType="real"/>
<Value><![CDATA[0]]></Value>
<Equation/></Variable>
<Variable ID="58" Name="kolRepeat" Pos="-100 390" NamePos="-90 390">
<VarType ScalarType="integer"/>
<Value><![CDATA[
0

]]></Value>
<Equation/></Variable>
<Variable ID="57" Name="timeEndI" Pos="-100 350" NamePos="-90 350">
<VarType ScalarType="real"/>
<Value><![CDATA[0]]></Value>
<Equation/></Variable>
<Variable ID="54" Name="timeUstI" Pos="-100 330" NamePos="-90 330">
<VarType ScalarType="real"/>
<Value><![CDATA[0]]></Value>
<Equation/></Variable>
<Variable ID="53" Name="timeTransfer" Pos="-100 410" NamePos="-90 410">
<VarType ScalarType="real"/>
<Value><![CDATA[0]]></Value>
<Equation/></Variable>
<Variable ID="52" Name="timeTransferI" Pos="-100 200" NamePos="-90 200">
<VarType ScalarType="real"/>
<Value><![CDATA[0]]></Value>
<Equation/></Variable>
<Variable ID="49" Name="endGSM" Pos="-20 130" NamePos="-10 130">
<VarType ScalarType="boolean"/>
<Value><![CDATA[false]]></Value>
<Equation/></Variable>
<Variable ID="48" Name="idGSM" Pos="-20 110" NamePos="-10 110">
<VarType ScalarType="real"/>
<Value><![CDATA[0]]></Value>
<Equation/></Variable>
<Variable ID="47" Name="timeScale" Pos="-100 90" NamePos="-90 89.9">
<VarType ScalarType="real"/>
<Value><![CDATA[60]]></Value>
<Equation/></Variable>
<Variable ID="44" Name="timeOutFromMIR" Pos="90 170" NamePos="100 170">
<VarType ScalarType="real"/>
<Value><![CDATA[
0

]]></Value>
<Equation/></Variable>
<Variable ID="45" Name="timeOutFromSET" Pos="90 150" NamePos="100 150">
<VarType ScalarType="real"/>
<Value><![CDATA[
0

]]></Value>
<Equation/></Variable>
<Variable ID="43" Name="bitrate" Pos="-100 110" NamePos="-90 110">
<VarType ScalarType="real"/>
<Value><![CDATA[0]]></Value>
<Equation/></Variable>
<Variable ID="41" Name="timeWaitCalling" Pos="-100 180" NamePos="-90 180">
<VarType ScalarType="real"/>
<Value><![CDATA[0]]></Value>
<Equation/></Variable>
<Variable ID="40" Name="timeService" Pos="-100 310" NamePos="-90 310">
<VarType ScalarType="real"/>
<Value><![CDATA[0]]></Value>
<Equation/></Variable>
<Variable ID="39" Name="BER" Pos="80 270" NamePos="90 270">
<VarType ScalarType="real"/>
<Value><![CDATA[0]]></Value>
<Equation/></Variable>
<Variable ID="37" Name="SNR" Pos="140 420" NamePos="150 420">
<VarType ScalarType="real" Rows="1" Columns="5"/>
<Value><![CDATA[0]]></Value>
<Equation RightHandSide="DistrUniform.sample(50,55)"/></Variable>
<Variable ID="36" Name="ID" Pos="-20 90" NamePos="-10 90">
<VarType ScalarType="integer"/>
<Value><![CDATA[0]]></Value>
<Equation/></Variable>
<Variable ID="35" Name="transferData" Pos="90 130" NamePos="100 130">
<VarType ScalarType="real"/>
<Value><![CDATA[0]]></Value>
<Equation/></Variable>
<Variable ID="34" Name="currentCounter" Pos="90 190" NamePos="100 190">
<VarType ScalarType="integer"/>
<Value><![CDATA[0]]></Value>
<Equation/></Variable>
<Variable ID="33" Name="statusCalling" Pos="-100 130" NamePos="-90 130">
<VarType ScalarType="boolean"/>
<Value><![CDATA[false]]></Value>
<Equation/></Variable>
<Variable ID="31" Name="statusBER" Pos="90 110" NamePos="100 110">
<VarType ScalarType="boolean"/>
<Value><![CDATA[false]]></Value>
<Equation/></Variable>
<Variable ID="30" Name="kolBlok" Pos="-10 290" NamePos="0 290">
<VarType ScalarType="integer"/>
<Value><![CDATA[
0

]]></Value>
<Equation/></Variable>
<Variable ID="28" Name="timeWaitAccess" Pos="-100 160" NamePos="-90 160">
<VarType ScalarType="real"/>
<Value><![CDATA[0]]></Value>
<Equation/></Variable>
<Variable ID="9" Name="kolEndGSM" Pos="-100 290" NamePos="-90 290">
<VarType ScalarType="real"/>
<Value><![CDATA[0]]></Value>
<Equation/></Variable>
<Statechart ID="5" Name="GSM" Pos="60 30" NamePos="70 30">
<Items>
<Initial ID="111" Name="pointer1" Parent="110" Target="106" Points="-70 100 -70 120"/>
<Initial ID="4" Name="pointer" Target="2" Points="30 -145 30 -110"/>
<ChoicePoint ID="99" Name="branch" Pos="-70 250" Parent="110" InCables="98" OutCables="105 100">
<Action><![CDATA[
BER=HataModel();
if (BER<=0)
{statusBER=false;}
else
{statusBER=randomTrue(BER);}
if (statusBER)
{repeatFrame=true;}
else if (statusBER==false)
{transferOk=true;}
]]></Action></ChoicePoint>
<ChoicePoint ID="79" Name="branch5" Pos="30 -20" InCables="116 21" OutCables="82 27">
<Action><![CDATA[
if (randomTrue(parVerUstGSM/100))
{connect=true;}
else
{disconnect=true;}
]]></Action></ChoicePoint>
<Transition ID="124" Name="transition4" Source="110" Target="47" Points="70 300 70 340 70 370 0 370" Type="4">
<Trigger><![CDATA["stopGSM"]]></Trigger>
<Action><![CDATA[
//timeTransfer=timeTransfer+timeService;
 
]]></Action></Transition>
<Transition ID="122" Name="transition3" Parent="110" Source="106" Target="85" Points="-70 140 -70 160" Type="4">
<Trigger><![CDATA["sendData"]]></Trigger></Transition>
<Transition ID="116" Name="transition20" Source="115" Target="79" Points="70 -20 40.5 -20" Type="1"/>
<Transition ID="114" Name="transition14" Source="113" Target="47" Points="-70 340 -70 360" Type="1">
<Trigger><![CDATA["nextStep"]]></Trigger></Transition>
<Transition ID="112" Name="transition19" Source="110" Target="113" Points="-70 300 -70 320" Type="4">
<Trigger><![CDATA["callEND"]]></Trigger></Transition>
<Transition ID="108" Name="transition13" Parent="110" Source="102" Target="106" Points="-190 280 -230 280 -230 130 -170 130" Type="1">
<Action><![CDATA[
model m = (model)getOwner();

for(int i=0;i<(m.parKolMasGSM.size()/2);i++)
{
 if (ID==i)
   {
    if (currentCounter==1)
       {
         if (timeTransferI>=20)
           {
           m.sETGSM.item(i).openCloseChannel = false;
           m.sETGSM.item(i).avTimeSETGSM=m.sETGSM.item(i).avTimeSETGSM+timeTransferI;
           m.sETGSM.item(i).oprosAlgoritm.fireEvent("receiveData");
           m.gSM.item(i).timeTransferI=0;
           }
         else 
           {
           m.sETGSM.item(i).avTimeSETGSM=m.sETGSM.item(i).avTimeSETGSM+timeTransferI;
           m.sETGSM.item(i).oprosAlgoritm.fireEvent("receiveData");
           m.gSM.item(i).timeTransferI=0;
           }

        }
    else if (currentCounter==2)
       {
        m.mIRGSM.item(i).oprosAlgoritm.fireEvent("receiveData");
         m.mIRGSM.item(i).avTimeMIRGSM=m.mIRGSM.item(i).avTimeMIRGSM+timeTransferI;
          m.gSM.item(i).timeTransferI=0;
       }
   }
}
    
]]></Action></Transition>
<Transition ID="105" Name="transition11" Parent="110" Source="99" Target="106" Points="-59.5 250 120 250 120 130 20 130" Type="1">
<Guard><![CDATA[transferOk]]></Guard>
<Action><![CDATA[
transferOk=false;
model m = (model)getOwner();

for(int i=0;i<(m.parKolMasGSM.size()/2);i++)
{
 if (ID==i)
   {
    if (currentCounter==1)
       {
              if (timeTransferI>=20)
           {
           m.sETGSM.item(i).openCloseChannel = false;
           m.sETGSM.item(i).oprosAlgoritm.fireEvent("receiveData");
           m.sETGSM.item(i).avTimeSETGSM=m.sETGSM.item(i).avTimeSETGSM+timeTransferI;
           m.gPRS.item(i).timeTransferI=0;
           
           }
         else 
           {
           m.sETGSM.item(i).avTimeSETGSM=m.sETGSM.item(i).avTimeSETGSM+timeTransferI;
           m.sETGSM.item(i).oprosAlgoritm.fireEvent("receiveData");
           m.gSM.item(i).timeTransferI=0;
           }
        }
    else if (currentCounter==2)
       {
        m.mIRGSM.item(i).oprosAlgoritm.fireEvent("receiveData");
        m.mIRGSM.item(i).avTimeMIRGSM=m.mIRGSM.item(i).avTimeMIRGSM+timeTransferI;
          m.gSM.item(i).timeTransferI=0;
       }
   }
}
    
]]></Action></Transition>
<Transition ID="100" Name="transition10" Parent="110" Source="99" Target="102" Points="-80.5 250 -170 250 -170 270" Type="1">
<Guard><![CDATA[repeatFrame]]></Guard>
<Action><![CDATA[repeatFrame=false;]]></Action></Transition>
<Transition ID="98" Name="transition9" Parent="110" Source="86" Target="99" Points="-70 220 -70 239.5" Type="1">
<Trigger><![CDATA["nextStep"]]></Trigger></Transition>
<Transition ID="87" Name="transition2" Parent="110" Source="85" Target="86" Points="-70 180 -70 200" Type="1">
<Trigger><![CDATA["nextStep"]]></Trigger></Transition>
<Transition ID="84" Name="transition24" Source="80" Target="110" Points="-70 60 -70 90" Type="1">
<Trigger><![CDATA["nextStep"]]></Trigger></Transition>
<Transition ID="83" Name="transition23" Source="81" Target="115" Points="190 50 210 50 210 -20 150 -20" Type="1">
<Trigger><![CDATA[1/timeScale]]></Trigger></Transition>
<Transition ID="82" Name="transition22" Source="79" Target="81" Points="38.7 -14.2 120 40" Type="1">
<Guard><![CDATA[disconnect]]></Guard></Transition>
<Transition ID="49" Name="transition15" Source="47" Target="2" Points="-70 380 -70 400 -270 400 -270 -100 -45 -100" Type="1"/>
<Transition ID="27" Name="transition6" Source="79" Target="80" Points="21.3 -14.2 -60 40" Type="1">
<Guard><![CDATA[connect]]></Guard></Transition>
<Transition ID="21" Name="transition1" Source="7" Target="79" Points="30 -50 30 -30.5" Type="1"/>
<Transition ID="6" Name="transition" Source="2" Target="7" Points="30 -90 30 -80 30 -70" Type="4">
<Trigger><![CDATA["startGSM"]]></Trigger></Transition>
<State ID="106" Name="Ожидание данных" Rect="-170 120 20 140" NamePos="-120 120" Parent="110" InCables="111 108 105" OutCables="122">
<EntryAction><![CDATA[bitrate=9600;]]></EntryAction></State>
<State ID="102" Name="Повтор передачи кадра" Rect="-190 270 -30 290" NamePos="-190 270" Parent="110" InCables="100" OutCables="108">
<EntryAction><![CDATA[

timeTransfer=timeTransfer+((transferData/bitrate)+timeoutALL);
timeTransferI=timeTransferI+((transferData/bitrate)+timeoutALL);
]]></EntryAction>
<ExitAction><![CDATA[kolRepeat++;]]></ExitAction></State>
<State ID="86" Name="Передача данных" Rect="-200 200 40 220" NamePos="-130 200" Parent="110" InCables="87" OutCables="98">
<EntryAction><![CDATA[
timeTransfer=timeTransfer+(transferData/bitrate);
timeTransferI=timeTransferI+(transferData/bitrate);
]]></EntryAction></State>
<State ID="85" Name="Общая задержка в радиоканале" Rect="-200 160 40 180" NamePos="-180 160" Parent="110" InCables="122" OutCables="87">
<EntryAction><![CDATA[
if (currentCounter==1)
    {
     timeTransfer=timeTransfer+timeOutFromSET;
     timeTransferI=timeTransferI+timeOutFromSET;
    }
else if (currentCounter==2)
    {
     timeTransfer=timeTransfer+timeOutFromMIR;
     timeTransferI=timeTransferI+timeOutFromMIR;
    }
timeoutALL=DistrNormal.sample(0.175,0.825);
timeTransfer=timeTransfer+timeoutALL;
timeTransferI=timeTransferI+timeoutALL;
]]></EntryAction></State>
<State ID="115" Name="Ждать" Rect="70 -30 150 -10" NamePos="90 -30" InCables="83" OutCables="116">
<EntryAction><![CDATA[timeWaitCalling=timeWaitCalling+5;]]></EntryAction></State>
<State ID="113" Name="Разрыв соединения" Rect="-150 320 0 340" NamePos="-140 320" InCables="112" OutCables="114">
<ExitAction><![CDATA[
timeEndI=uniform(1,parVrEndGSM);
timeService=timeService+timeEndI;
//timeTransfer=timeTransfer+timeService;

]]></ExitAction></State>
<State ID="110" Rect="-250 90 150 300" NamePos="-250 90" Children="106 102 86 85 111 99 122 108 105 100 98 87" InCables="84" OutCables="124 112">
<EntryAction><![CDATA[
endGSM=randomTrue(parVerEndGSM/100);
idGSM = this.getCurrentState();
if (endGSM)
{
 model m = (model)getOwner();
 m.gSM.item(ID).GSM.fireEvent("stopGSM");
 kolEndGSM++;
 if (currentCounter==1)
   {
     m.sETGSM.item(ID).oprosAlgoritm.stop();
     m.sETGSM.item(ID).oprosAlgoritm.startup();
     m.sETGSM.item(ID).closeChannelSET++;  
   }
     else if (currentCounter==2)
   {
     m.mIRGSM.item(ID).oprosAlgoritm.stop();
     m.mIRGSM.item(ID).oprosAlgoritm.startup();
     m.mIRGSM.item(ID).closeChannelMIR++;  
   }
     endGSM=false;
}
]]></EntryAction></State>
<State ID="81" Name="Неудачный дозвон" Rect="50 40 190 60" NamePos="60 40" InCables="82" OutCables="83">
<EntryAction><![CDATA[kolNeudach++;]]></EntryAction>
<ExitAction><![CDATA[disconnect=false;]]></ExitAction></State>
<State ID="80" Name="Установление соединения" Rect="-170 40 20 60" NamePos="-160 40" InCables="27" OutCables="84">
<ExitAction><![CDATA[
statusCalling=true;

model m = (model)getOwner();
for(int i=0;i<(m.parKolMasGSM.size()/2);i++)
{
 if (ID==i)
   {
    if (currentCounter==1)
       {
        m.sETGSM.item(i).oprosAlgoritm.fireEvent("callOK");
       }
    else if (currentCounter==2)
       {
        m.mIRGSM.item(i).oprosAlgoritm.fireEvent("callOK");
       }
   }
}
timeUstI=(uniform(1,parVrUstGSM)+timeWaitCalling);
timeService=timeService+timeUstI;
timeWaitCalling=0;
connect = false;
]]></ExitAction></State>
<State ID="47" Name="Конец" Rect="-150 360 0 380" NamePos="-90 360" InCables="124 114" OutCables="49">
<EntryAction><![CDATA[
model.kolFinishGSM++;
if (model.kolFinishGSM==(model.parKolMasGSM.size())/2)
{model.finishAllGSM=true;}
statusCalling=false;
]]></EntryAction></State>
<State ID="7" Name="Процедура дозвона" Rect="-45 -70 105 -50" NamePos="-35 -70" InCables="6" OutCables="21"/>
<State ID="2" Name="Начало" Rect="-45 -110 105 -90" NamePos="5 -110" InCables="4 49" OutCables="6"/>
</Items></Statechart>
<Port ID="3" Name="portOut" Pos="260 230" Parent="1"/>
<Port ID="2" Name="portIn" Pos="-140 230" Parent="1"/>
<Bounds Flags="0" Pen="#808080 20" Brush="#000000" ID="1" Name="GSM" Rect="-140 10 260 450" NamePos="-130 20" Children="3 2"/>
<Comment ID="78" Name="textBox3" Rect="70 50 240 220">
<Text><![CDATA[Вспомогательные переменные]]></Text></Comment>
<Comment ID="63" Name="textBox4" Rect="70 240 240 430">
<Text><![CDATA[Модель Хаты]]></Text></Comment>
<Comment ID="60" Name="textBox" Rect="-120 50 50 220">
<Text><![CDATA[Системные переменные]]></Text></Comment>
<Comment ID="29" Name="textBox5" Rect="-120 240 50 430">
<Text><![CDATA[
Собираемая статистика

]]></Text></Comment>
<Comment ID="10" Name="textBox1" Rect="0 -170 500 -70">
<Text><![CDATA[
kolEndGSM - количество внезапно разорванных соединений всего
kolEndGSMSet - количество внезапно разорванных соединений во время опроса СЭТ
kolEndGSMMir - количество внезапно разорванных соединений во время опроса МИР

]]></Text></Comment>
</StructureDiagram><Image/>
<Parameters>
<Item Name="parVerUstGSM" DefaultValue="90" Modificator="2"/>
<Item Name="parVerEndGSM" DefaultValue="2" Modificator="2"/>
<Item Name="parVrEndGSM" DefaultValue="3" Modificator="2"/>
<Item Name="parVrUstGSM" DefaultValue="10" Modificator="2"/>
<Item Name="timeWave" DefaultValue="0.1" Modificator="2"/>
</Parameters>
<IconDiagram>
<Port ID="1" Name="portOut" Pos="30 0" PrototypeID="3"/>
<Port ID="2" Name="portIn" Pos="-30 0" PrototypeID="2"/>
<Text ID="5" Name="text" Rect="-14 -9 14.1 7.4" Flags="28680" Pen="no 0" Brush="#000000" Font="Tahoma,12">
<Text><![CDATA[GSM]]></Text></Text>
<Rectangle Pen="#f5912d 10" Brush="#f7aa5e" ID="3" Name="rectangle" Rect="-30 -20 30 20"/>
<Rectangle Pen="no 0" Brush="#c0c0c0" ID="4" Rect="-27.5 -17.5 32.5 22.5"/>
</IconDiagram></Item>
<Item Name="MIRC01" Expanded="y">
<Import><![CDATA[import javax.swing.*;]]></Import>
<AdditionalClassCode><![CDATA[
public static boolean startMIR = false;
boolean allMIR,openCloseChannel,openIs,closeIs,MIRdontwork,MIRwork = false;
boolean netMIR,estMIR,nextMIR,nextIArray,allIArray,estEvent,estEnergy,estPower, estDopPar,someNo = false;
//int iArray = 0;
boolean noManyArray,oprosManyArray,estManyArray,nextData,allData = false; 

double getTimeOut(){
double i;
double meanDistr = (timeOutOfSpeed(bitrate) + (maxTimeoutAnswer - timeOutOfSpeed(bitrate))/2);
double sigmaDistr = maxTimeoutAnswer - meanDistr;
i = DistrUniform.sample(timeOutOfSpeed(bitrate),maxTimeoutAnswer);
return i;
}

static boolean checkVector(Vector a){
boolean s = false;
int j = 0;
for (int i = 0;i<=a.size()-1;i++){
if (((Double)a.get(i)).doubleValue() != 0)
   j++;
}
if (j==0)
   s=true;
return s;
}
]]></AdditionalClassCode>
<ConversionTables>
<Item Name="timeOutOfSpeed" TransformationType="2" PolynomOrder="3" ArgOutOfRangeReactionType="2">
<RecordList>
<Record Arg="1200" Fun="0.049"/>
<Record Arg="2400" Fun="0.025"/>
<Record Arg="4800" Fun="0.013"/>
<Record Arg="9600" Fun="0.007"/>
</RecordList></Item>
</ConversionTables>
<StructureDiagram>
<ChartTimer ID="15" Name="timerTimeOut" Pos="230 -60" NamePos="240 -59.9" Timeout="1.0">
<ExpiryAction><![CDATA[oprosAlgoritm.fireEvent("nextStep");]]></ExpiryAction></ChartTimer>
<Variable ID="33" Name="iArray" Pos="230 210" NamePos="240 210">
<VarType ScalarType="integer"/>
<Value><![CDATA[0]]></Value>
<Equation/></Variable>
<Variable ID="30" Name="closeChannelMIR" Pos="30 210" NamePos="40 210">
<VarType ScalarType="real"/>
<Value><![CDATA[0]]></Value>
<Equation/></Variable>
<Variable ID="29" Name="avTimeMIRGSM" Pos="30 190" NamePos="40 190">
<VarType ScalarType="real"/>
<Equation/></Variable>
<Variable ID="28" Name="avTimeMIRGPRS" Pos="30 170" NamePos="40 170">
<VarType ScalarType="real"/>
<Equation/></Variable>
<Variable ID="26" Name="timeScale" Pos="200 170" NamePos="210 169.9">
<VarType ScalarType="real"/>
<Value><![CDATA[60]]></Value>
<Equation/></Variable>
<Variable ID="24" Name="ID" Pos="200 150" NamePos="210 150">
<VarType ScalarType="integer"/>
<Value><![CDATA[0]]></Value>
<Equation/></Variable>
<Variable ID="23" Name="currentChannel" Pos="30 50" NamePos="40 49.9">
<VarType ScalarType="integer"/>
<Value><![CDATA[0]]></Value>
<Equation/></Variable>
<Variable ID="20" Name="indexEventJournal" Pos="30 10" NamePos="40 10">
<VarType ScalarType="integer"/>
<Value><![CDATA[1]]></Value>
<Equation/></Variable>
<Variable ID="18" Name="indexArray" Pos="30 30" NamePos="40 30">
<VarType ScalarType="integer"/>
<Value><![CDATA[0]]></Value>
<Equation/></Variable>
<Variable ID="16" Name="MIRdontAnswer" Pos="30 240" NamePos="40 240">
<VarType ScalarType="integer"/>
<Value><![CDATA[0]]></Value>
<Equation/></Variable>
<Variable ID="12" Name="timeOutAnswer" Pos="200 130" NamePos="210 130">
<VarType ScalarType="real"/>
<Value><![CDATA[0.1]]></Value>
<Equation RightHandSide="DistrNormal.sample(0.05,0.15)"/></Variable>
<Variable ID="5" Name="closeChannel" Pos="200 110" NamePos="210 110">
<VarType Sort="1" ScalarType="real" Rows="1" Columns="2"/>
<Value><![CDATA[8*[4,4]]]></Value>
<Equation Type="1" RightHandSide="8*[10,11]"/></Variable>
<Variable ID="6" Name="openChannel" Pos="200 90" NamePos="210 90">
<VarType Sort="1" ScalarType="real" Rows="1" Columns="2"/>
<Equation Type="1" RightHandSide="8*[19,11]"/></Variable>
<Variable ID="8" Name="arrayEventJournal" Pos="200 70" NamePos="210 70">
<VarType Sort="1" ScalarType="real" Rows="1" Columns="44"/>
<Equation Type="1" RightHandSide="8*[10,13,12,23,10,13,12,23,10,13,12,23,10,13,12,23,10,13,12,23,10,13,12,23,10,13,12,23,10,13,12,23,10,13,12,23,10,13,12,23,10,13,12,23]"/></Variable>
<Variable ID="9" Name="arrayParametrs" Pos="200 50" NamePos="210 50">
<VarType Sort="1" ScalarType="real" Rows="1" Columns="28"/>
<Equation Type="1" RightHandSide="8*[11,112,11,13,11,15,11,15,11,17,11,37]"/></Variable>
<Variable ID="10" Name="arrayEnergy" Pos="200 30" NamePos="210 30">
<VarType Sort="1" ScalarType="integer" Rows="1" Columns="2"/>
<Equation Type="1" RightHandSide="8*[12,27]"/></Variable>
<Variable ID="11" Name="arrayPowerProfile" Pos="200 10" NamePos="210 10">
<VarType Sort="1" ScalarType="integer" Rows="1" Columns="2"/>
<Equation Type="1" RightHandSide="8*[10,13,14,53]"/></Variable>
<Variable ID="4" Name="indexMIR" Pos="30 70" NamePos="40 69.9">
<VarType ScalarType="real"/>
<Value><![CDATA[1]]></Value>
<Equation/></Variable>
<Statechart ID="3" Name="oprosAlgoritm" Pos="110 -60" NamePos="120 -60">
<Items>
<Initial ID="1" Name="pointer" Target="19" Points="80 -90 80 -70"/>
<ChoicePoint ID="284" Name="branch6" Pos="-80 680" InCables="293" OutCables="286 287">
<Action><![CDATA[

 if(randomTrue(verNoAnswer/100))
{MIRdontwork=true;}
else
{MIRwork=true;}
]]></Action></ChoicePoint>
<ChoicePoint ID="285" Name="branch2" Pos="-80 540" InCables="297" OutCables="289 294 295">
<Action><![CDATA[
if (iArray == 0)
{
   if (indexArray < arrayEventJournal.getColumnDimension()/2)
      {
       if (indexArray%2==0)
         {
          
           nextData=true;
           noManyArray = true;
           estManyArray = false;
         }
       else if (indexArray%2==1)
           {
           if (indexEventJournal< 10)
              { 
                oprosManyArray=true;
                noManyArray = false;
                estManyArray = true;
              }
           else if (indexEventJournal==10)
                   {
                      oprosManyArray=true;
                      noManyArray = true;
                      estManyArray = false;
                   }
           }

      }
 
   else
      {allData = true;}
}

else if (iArray==1)
{
 if (indexArray < arrayEnergy.getColumnDimension()/2)
      {nextData = true;
       noManyArray = true;
      }
   else
      {allData = true;}
}
else if (iArray==2)
{
 if (indexArray < arrayPowerProfile.getColumnDimension()/2)
      {
       if (indexArray%2==0)
          {
           nextData=true;
           noManyArray = true;
           estManyArray = false;
          }
       else if(indexArray%2==1)
              {
               if (indexEventJournal< 12)
                  { 
                   oprosManyArray=true;
                   noManyArray = false;
                   estManyArray = true;
                  }
               else if (indexEventJournal==12)
                       {
                        oprosManyArray=true;
                        noManyArray = true;
                        estManyArray = false;
                       }
   
               }
      
      }
      
      
        else
      {allData = true;}

}
else if (iArray==3)
{
 if (indexArray < arrayParametrs.getColumnDimension()/2)
      {nextData = true;
   noManyArray = true;
      }
   else
      {allData = true;}
}


]]></Action></ChoicePoint>
<ChoicePoint ID="262" Name="branch4" Pos="100 330" InCables="310 265 213" OutCables="279 266">
<Action><![CDATA[

if (iArray<=3)
{nextIArray=true;}
else
{allIArray=true;}

]]></Action></ChoicePoint>
<ChoicePoint ID="263" Name="branch5" Pos="100 370" InCables="266" OutCables="328 327 281 280 265">
<Action><![CDATA[
if ( ((Double)parReqData.get(iArray)).doubleValue()==1 & iArray ==0 )
{estEvent = true;}
else if (((Double)parReqData.get(iArray)).doubleValue()==1 & iArray ==1)
{estEnergy = true;}
else if (((Double)parReqData.get(iArray)).doubleValue()==1 & iArray ==2)
{estPower = true;}
else if (((Double)parReqData.get(iArray)).doubleValue()==1 & iArray ==3)
{estDopPar = true;}
else 
{someNo = true;}
]]></Action></ChoicePoint>
<ChoicePoint ID="264" Name="branch3" Pos="40 490" InCables="331 329 298 299 271 274" OutCables="297">
<Action><![CDATA[
if (openCloseChannel){
openIs = true;
}
]]></Action></ChoicePoint>
<ChoicePoint ID="3" Name="branch" Pos="80 60" InCables="319 317" OutCables="11 12">
<Action><![CDATA[
model m = (model)getOwner();
if (currentChannel==1)
   {
    if (((Double)m.parKolMasGSM.get(2*ID+1)).doubleValue()==0)
       {netMIR=true;}
    else
       {estMIR=true;}
   }
else if (currentChannel==2)
   {
    if (((Double)m.parKolMasGPRS.get(2*ID+1)).doubleValue()==0)
       {netMIR=true;}
    else
       {estMIR=true;}
   }

]]></Action></ChoicePoint>
<ChoicePoint ID="2" Name="branch1" Pos="-40 100" InCables="231 12" OutCables="261 260">
<Action><![CDATA[
model m = (model)getOwner();
estMIR = false;
if (currentChannel==1)
   {
    if (indexMIR <= ((Double)m.parKolMasGSM.get(2*ID+1)).doubleValue() )
       {nextMIR =true;}
    else
       {allMIR = true;}
   }
else if (currentChannel==2)
   {
    if (indexMIR <= ((Double)m.parKolMasGPRS.get(2*ID+1)).doubleValue() )
       {nextMIR =true;}
    else
       {allMIR = true;}
   }



]]></Action></ChoicePoint>
<Transition ID="331" Name="transition34" Source="277" Target="264" Points="130 430 130 460 55 460 44.7 480.6" Type="1"/>
<Transition ID="329" Name="transition31" Source="276" Target="264" Points="-20 430 -20 460 30 460 36.7 480.1" Type="1"/>
<Transition ID="328" Name="transition30" Source="263" Target="276" Points="90.7 374.6 80 380 -20 380 -20 410" Type="1">
<Guard><![CDATA[estEnergy]]></Guard></Transition>
<Transition ID="327" Name="transition17" Source="263" Target="275" Points="89.5 370 -180 370 -180 410" Type="1">
<Guard><![CDATA[estEvent]]></Guard></Transition>
<Transition ID="325" Name="transition27" Source="326" Target="234" Points="470 410 470 430" Type="4">
<Trigger><![CDATA["nextStep"]]></Trigger></Transition>
<Transition ID="323" Name="transition25" Source="324" Target="307" Points="-80 760 -80 780" Type="4">
<Trigger><![CDATA["nextStep"]]></Trigger></Transition>
<Transition ID="321" Name="transition16" Source="322" Target="247" Points="100 220 100 240" Type="4">
<Trigger><![CDATA["nextStep"]]></Trigger></Transition>
<Transition ID="320" Name="transition14" Source="234" Target="257" Points="470 450 470 470" Type="4">
<Trigger><![CDATA["receiveData"]]></Trigger></Transition>
<Transition ID="319" Name="transition33" Source="315" Target="3" Points="120 30 88.4 53.7" Type="1"/>
<Transition ID="317" Name="transition32" Source="313" Target="3" Points="40 30 71.6 53.7" Type="4">
<Trigger><![CDATA["callOK"]]></Trigger></Transition>
<Transition ID="316" Name="transition29" Source="16" Target="315" Points="90 -10 120 10" Type="4">
<Trigger><![CDATA["startMIRGPRS"]]></Trigger></Transition>
<Transition ID="310" Name="transition37" Source="305" Target="262" Points="100 600 100 880 -260 880 -260 330 89.5 330" Type="1"/>
<Transition ID="286" Name="transition44" Source="284" Target="301" Points="-69.5 680 10 680 10 700" Type="1">
<Guard><![CDATA[MIRdontwork]]></Guard></Transition>
<Transition ID="287" Name="transition43" Source="284" Target="324" Points="-80 690.5 -80 740" Type="1">
<Guard><![CDATA[MIRwork]]></Guard></Transition>
<Transition ID="288" Name="transition42" Source="302" Target="308" Points="-20 610 -80 630" Type="1"/>
<Transition ID="289" Name="transition40" Source="285" Target="302" Points="-72.6 547.4 -30 590" Type="1">
<Guard><![CDATA[oprosManyArray]]></Guard></Transition>
<Transition ID="291" Name="transition26" Source="307" Target="303" Points="-80 800 -80 820" Type="4">
<Trigger><![CDATA["receiveData"]]></Trigger></Transition>
<Transition ID="293" Name="transition24" Source="308" Target="284" Points="-80 650 -80 669.5" Type="4">
<Trigger><![CDATA["receiveData"]]></Trigger></Transition>
<Transition ID="294" Name="transition19" Source="285" Target="308" Points="-82.2 550.2 -100 630" Type="1">
<Guard><![CDATA[nextData]]></Guard></Transition>
<Transition ID="295" Name="transition18" Source="285" Target="305" Points="-69.8 542.2 100 580" Type="1">
<Guard><![CDATA[allData]]></Guard></Transition>
<Transition ID="297" Name="transition22" Source="264" Target="285" Points="30.4 494 -70.4 536" Type="1">
<Guard><![CDATA[openIs]]></Guard></Transition>
<Transition ID="298" Name="transition41" Source="303" Target="264" Points="-160 830 -180 830 -180 510 29.6 490.9" Type="8">
<Trigger><![CDATA[estManyArray == true]]></Trigger>
<Action><![CDATA[indexEventJournal++;]]></Action></Transition>
<Transition ID="299" Name="transition28" Source="303" Target="264" Points="-80 840 -80 860 -200 860 -200 490 29.5 490" Type="8">
<Trigger><![CDATA[noManyArray == true]]></Trigger>
<Action><![CDATA[
indexArray++;
indexEventJournal = 1;
]]></Action></Transition>
<Transition ID="300" Name="transition48" Source="301" Target="257" Points="10 720 10 740 470 740 470 490" Type="1"/>
<Transition ID="281" Name="transition11" Source="263" Target="277" Points="109.9 373.3 130 380 130 400 130 410" Type="1">
<Guard><![CDATA[estPower]]></Guard></Transition>
<Transition ID="280" Name="transition10" Source="263" Target="278" Points="110.5 370 280 370 280 410" Type="1">
<Guard><![CDATA[estDopPar]]></Guard></Transition>
<Transition ID="279" Name="transition8" Source="262" Target="235" Points="110.5 330 470 330 470 350" Type="1">
<Guard><![CDATA[allIArray]]></Guard></Transition>
<Transition ID="265" Name="transition39" Source="263" Target="262" Points="89.6 368.7 60 365 50 350 65 335 89.7 331.4" Type="1">
<Guard><![CDATA[someNo]]></Guard>
<Action><![CDATA[
iArray++;
 someNo = false;
]]></Action></Transition>
<Transition ID="266" Name="transition23" Source="262" Target="263" Points="100 340.5 100 359.5" Type="1">
<Guard><![CDATA[nextIArray]]></Guard>
<Action><![CDATA[nextIArray = false;]]></Action></Transition>
<Transition ID="271" Name="transition36" Source="278" Target="264" Points="280 430 280 470 120 470 50.1 487.5" Type="1"/>
<Transition ID="274" Name="transition21" Source="275" Target="264" Points="-180 430 -180 470 -30 470 30 487.2" Type="1"/>
<Transition ID="261" Name="transition6" Source="2" Target="14" Points="-46.3 108.4 -70 140 -115 140 -120 160" Type="1">
<Guard><![CDATA[allMIR]]></Guard></Transition>
<Transition ID="260" Name="transition5" Source="2" Target="256" Points="-33.7 108.4 -10 140 100 140 100 160" Type="1">
<Guard><![CDATA[nextMIR]]></Guard></Transition>
<Transition ID="200" Name="transition46" Source="235" Target="326" Points="470 370 470 390" Type="4">
<Trigger><![CDATA["receiveData"]]></Trigger></Transition>
<Transition ID="213" Name="transition20" Source="255" Target="262" Points="100 300 100 319.5" Type="1"/>
<Transition ID="224" Name="transition15" Source="247" Target="255" Points="100 260 100 280" Type="4">
<Trigger><![CDATA["receiveData"]]></Trigger></Transition>
<Transition ID="226" Name="transition13" Source="256" Target="322" Points="100 180 100 200" Type="4">
<Trigger><![CDATA["receiveData"]]></Trigger></Transition>
<Transition ID="231" Name="transition9" Source="257" Target="2" Points="570 480 580 480 580 240 580 120 120 120 -29.6 101.3" Type="1"/>
<Transition ID="20" Name="transition7" Source="14" Target="16" Points="-190 170 -220 170 -220 -20 30 -20" Type="1">
<Action><![CDATA[
model m = (model)getOwner();
if (currentChannel==1)
{
 for(int i=0;i<m.parKolMasGSM.size()/2;i++)
    {
     if (ID==i)
       {
          if (m.mIRGSM.item(i).allMIR & m.sETGSM.item(i).allSET)
             {
                  m.mIRGSM.item(i).allMIR=false;
                  m.sETGSM.item(i).allSET=false;
                  m.gSM.item(i).GSM.fireEvent("callEND");
                // model.kolFinishGSM++;
              //   m.gSM.item(i).GSM.fireEvent("callEND");
           /*   if (model.kolFinishGSM==(model.parKolMasGSM.size())/2)
                 {
                 m.gSM.item(i).GSM.fireEvent("callEND");
                 //model.finishAllGSM=true;
                 }*/
             }
          else if (m.mIRGSM.item(i).allMIR==true & m.sETGSM.item(i).allSET==false)
             {
               m.sETGSM.item(i).oprosAlgoritm.fireEvent("startSETGSM");
             }
       
          


         
        }
    }
}
else if (currentChannel==2)
{
 for(int i=0;i<m.parKolMasGPRS.size()/2;i++)
    {
     if (ID==i)
       {
          if (m.mIRGPRS.item(i).allMIR & m.sETGPRS.item(i).allSET)
             {
                  m.mIRGPRS.item(i).allMIR=false;
                  m.sETGPRS.item(i).allSET=false;
                 model.kolFinishGPRS++;
              if (model.kolFinishGPRS==(model.parKolMasGPRS.size())/2)
                 {
                  model.finishAllGPRS=true;
              
                 }
             }
          else if (m.mIRGPRS.item(i).allMIR==true & m.sETGPRS.item(i).allSET==false)
             {
               m.sETGPRS.item(i).oprosAlgoritm.fireEvent("startSETGPRS");
             }
       
          


         
        }
    }
}


]]></Action></Transition>
<Transition ID="9" Name="transition4" Source="16" Target="313" Points="70 -10 40 10" Type="4">
<Trigger><![CDATA["startMIRGSM"]]></Trigger></Transition>
<Transition ID="10" Name="transition3" Source="15" Target="16" Points="270 80 270 50 270 -20 130 -20" Type="1"/>
<Transition ID="11" Name="transition2" Source="3" Target="15" Points="89.9 63.3 170 90" Type="1">
<Guard><![CDATA[netMIR]]></Guard></Transition>
<Transition ID="12" Name="transition1" Source="3" Target="2" Points="70.1 63.3 -30.1 96.7" Type="1">
<Guard><![CDATA[estMIR]]></Guard></Transition>
<Transition ID="13" Name="transition" Source="19" Target="16" Points="80 -50 80 -30" Type="1"/>
<State ID="326" Name="Тайм-аут ответа2" Rect="360 390 570 410" NamePos="420 390" InCables="200" OutCables="325">
<EntryAction><![CDATA[
timeOutAnswer=getTimeOut();
//timerTimeOut.restart(timeOutAnswer/timeScale);
//timerTimeOut.restart(timeOutAnswer);
timerTimeOut.restart(0);
]]></EntryAction></State>
<State ID="324" Name="Тайм-аут ответа1" Rect="-160 740 -10 760" NamePos="-140 740" InCables="287" OutCables="323">
<EntryAction><![CDATA[
timeOutAnswer=getTimeOut();
timerTimeOut.restart(0);
]]></EntryAction></State>
<State ID="322" Name="Тайм-аут ответа" Rect="-10 200 200 220" NamePos="50 200" InCables="226" OutCables="321">
<EntryAction><![CDATA[
timeOutAnswer=getTimeOut();
//timerTimeOut.restart(timeOutAnswer/timeScale);
//timerTimeOut.restart(timeOutAnswer);
timerTimeOut.restart(0);
]]></EntryAction></State>
<State ID="315" Name="по GPRS" Rect="90 10 150 30" NamePos="90 10" InCables="316" OutCables="319">
<EntryAction><![CDATA[currentChannel=2;]]></EntryAction></State>
<State ID="313" Name="по GSM" Rect="10 10 70 30" NamePos="10 10" InCables="9" OutCables="317">
<EntryAction><![CDATA[
currentChannel=1;
model m = (model)getOwner();
for(int i=0;i<(m.parKolMasGSM.size()/2);i++)
{
     if (ID==i)
       {
        m.gSM.item(i).currentCounter=2;
        if (m.gSM.item(i).statusCalling==false)
           {m.gSM.item(i).GSM.fireEvent("startGSM");}
        else if (m.gSM.item(i).statusCalling)
           {this.fireEvent("callOK");}
        
        
       }
}

]]></EntryAction></State>
<State ID="301" Name="Счётчик не отвечает" Rect="-60 700 90 720" NamePos="-50 700" InCables="286" OutCables="300">
<EntryAction><![CDATA[
MIRdontwork = false;
MIRdontAnswer++;
]]></EntryAction>
<ExitAction><![CDATA[
indexArray = 0;
indexEventJournal = 1;
]]></ExitAction></State>
<State ID="302" Name="Ещё массив" Rect="-70 590 20 610" NamePos="-60 590" InCables="289" OutCables="288">
<ExitAction><![CDATA[oprosManyArray = false;]]></ExitAction></State>
<State ID="303" Name="След. параметр" Rect="-160 820 -10 840" NamePos="-140 820" InCables="291" OutCables="298 299"/>
<State ID="305" Name="След. массив" Rect="40 580 150 600" NamePos="50 580" InCables="295" OutCables="310">
<ExitAction><![CDATA[
allData = false;
indexArray = 0;
iArray++;
]]></ExitAction></State>
<State ID="307" Name="Ответ" Rect="-160 780 -10 800" NamePos="-100 780" InCables="323" OutCables="291">
<EntryAction><![CDATA[
MIRwork = false;
model m = (model)getOwner();
if (currentChannel==1)
{
  for(int i=0;i<(m.parKolMasGSM.size()/2);i++)
    {
     if (ID==i)
       {
        if (iArray == 0)
        {
          m.gSM.item(i).transferData=arrayEventJournal.get(0,2*(indexArray+1)-1);
        }
        else if (iArray==1)
        {
          m.gSM.item(i).transferData=arrayEnergy.get(0,2*(indexArray+1)-1);
        }
        else if (iArray==2)
        {
          m.gSM.item(i).transferData=arrayPowerProfile.get(0,2*(indexArray+1)-1);
        }
        else if (iArray==3)
        {
          m.gSM.item(i).transferData=arrayParametrs.get(0,2*(indexArray+1)-1);
        }
   m.gSM.item(i).timeOutFromMIR=timeOutAnswer;
        m.gSM.item(i).GSM.fireEvent("sendData");
       }
    }
}
else if (currentChannel==2)
{
 for(int i=0;i<(m.parKolMasGPRS.size()/2);i++)
    {
     if (ID==i)
       {
        if (iArray == 0)
        {
          m.gPRS.item(i).transferData=arrayEventJournal.get(0,2*(indexArray+1)-1);
        }
        else if (iArray==1)
        {
          m.gPRS.item(i).transferData=arrayEnergy.get(0,2*(indexArray+1)-1);
        }
        else if (iArray==2)
        {
          m.gPRS.item(i).transferData=arrayPowerProfile.get(0,2*(indexArray+1)-1);
        }
        else if (iArray==3)
        {
          m.gPRS.item(i).transferData=arrayParametrs.get(0,2*(indexArray+1)-1);
        }
        m.gPRS.item(i).timeOutFromMIR=timeOutAnswer;
        m.gPRS.item(i).currentCounter=2;
        m.gPRS.item(i).transferCondition=2;
        m.gPRS.item(i).GPRS.fireEvent("sendData");
       }
    }
}
]]></EntryAction></State>
<State ID="308" Name="Запрос" Rect="-120 630 -40 650" NamePos="-100 630" InCables="288 294" OutCables="293">
<EntryAction><![CDATA[
model m = (model)getOwner();
if (currentChannel==1)
{
  for(int i=0;i<(m.parKolMasGSM.size()/2);i++)
    {
     if (ID==i)
       {
        if (iArray == 0)
        {
          m.gSM.item(i).transferData=arrayEventJournal.get(0,2*(indexArray));
        }
        else if (iArray==1)
        {
          m.gSM.item(i).transferData=arrayEnergy.get(0,2*(indexArray));
        }
        else if (iArray==2)
        {
          m.gSM.item(i).transferData=arrayPowerProfile.get(0,2*(indexArray));
        }
        else if (iArray==3)
        {
          m.gSM.item(i).transferData=arrayParametrs.get(0,2*(indexArray));
        }
  
        m.gSM.item(i).GSM.fireEvent("sendData");
       }
    }
}
else if (currentChannel==2)
{
 for(int i=0;i<(m.parKolMasGPRS.size()/2);i++)
    {
     if (ID==i)
       {
        if (iArray == 0)
        {
          m.gPRS.item(i).transferData=arrayEventJournal.get(0,2*(indexArray));
        }
        else if (iArray==1)
        {
          m.gPRS.item(i).transferData=arrayEnergy.get(0,2*(indexArray));
        }
        else if (iArray==2)
        {
          m.gPRS.item(i).transferData=arrayPowerProfile.get(0,2*(indexArray));
        }
        else if (iArray==3)
        {
          m.gPRS.item(i).transferData=arrayParametrs.get(0,2*(indexArray));
        }
        m.gPRS.item(i).currentCounter=2;
        m.gPRS.item(i).transferCondition=1;
        m.gPRS.item(i).GPRS.fireEvent("sendData");
       }
    }
}
]]></EntryAction>
<ExitAction><![CDATA[nextData = false;]]></ExitAction></State>
<State ID="275" Name="Журнал событий" Rect="-250 410 -100 430" NamePos="-230 410" InCables="327" OutCables="274">
<ExitAction><![CDATA[estEvent = false;]]></ExitAction></State>
<State ID="276" Name="Энергия за сутки" Rect="-90 410 50 430" NamePos="-70 410" InCables="328" OutCables="329">
<ExitAction><![CDATA[estEnergy = false;]]></ExitAction></State>
<State ID="277" Name="Срезы мощности" Rect="60 410 200 430" NamePos="80 410" InCables="281" OutCables="331">
<ExitAction><![CDATA[estPower = false;]]></ExitAction></State>
<State ID="278" Name="Доп. параметры" Rect="210 410 350 430" NamePos="230 410" InCables="280" OutCables="271">
<ExitAction><![CDATA[estDopPar = false;]]></ExitAction></State>
<State ID="234" Name="Закрытие сеанса(ответ)" Rect="360 430 570 450" NamePos="380 430" InCables="325" OutCables="320">
<EntryAction><![CDATA[
model m = (model)getOwner();
if (currentChannel==1)
{
  for(int i=0;i<(m.parKolMasGSM.size()/2);i++)
    {
     if (ID==i)
       {
        m.gSM.item(i).timeOutFromMIR=timeOutAnswer;
        m.gSM.item(i).transferData=closeChannel.get(0,1);
        m.gSM.item(i).GSM.fireEvent("sendData");
       }
    }
}
else if (currentChannel==2)
{
 for(int i=0;i<(m.parKolMasGPRS.size()/2);i++)
    {
     if (ID==i)
       {
        m.gPRS.item(i).timeOutFromMIR=timeOutAnswer;
        m.gPRS.item(i).currentCounter=2;
        m.gPRS.item(i).transferCondition=2;
        m.gPRS.item(i).transferData=closeChannel.get(0,1);
        m.gPRS.item(i).GPRS.fireEvent("sendData");
       }
    }
}
]]></EntryAction></State>
<State ID="235" Name="Закрытие сеанса(запрос)" Rect="360 350 570 370" NamePos="380 350" InCables="279" OutCables="200">
<EntryAction><![CDATA[
model m = (model)getOwner();
if (currentChannel==1)
{
  for(int i=0;i<(m.parKolMasGSM.size()/2);i++)
    {
     if (ID==i)
       {
        m.gSM.item(i).transferData=closeChannel.get(0,0);
        m.gSM.item(i).GSM.fireEvent("sendData");
       }
    }
}
else if (currentChannel==2)
{
 for(int i=0;i<(m.parKolMasGPRS.size()/2);i++)
    {
     if (ID==i)
       {
        m.gPRS.item(i).currentCounter=2;
        m.gPRS.item(i).transferCondition=1;
        m.gPRS.item(i).transferData=closeChannel.get(0,0);
        m.gPRS.item(i).GPRS.fireEvent("sendData");
       }
    }
}
]]></EntryAction></State>
<State ID="247" Name="Открытие сеанса(ответ)" Rect="-10 240 200 260" NamePos="10 240" InCables="321" OutCables="224">
<EntryAction><![CDATA[
openCloseChannel = true;
model m = (model)getOwner();
if (currentChannel==1)
{
  for(int i=0;i<(m.parKolMasGSM.size()/2);i++)
    {
     if (ID==i)
       {
        m.gSM.item(i).timeOutFromMIR=timeOutAnswer;
        m.gSM.item(i).transferData=openChannel.get(0,1);
        m.gSM.item(i).GSM.fireEvent("sendData");
       }
    }
}
else if (currentChannel==2)
{
 for(int i=0;i<(m.parKolMasGPRS.size()/2);i++)
    {
     if (ID==i)
       {
        m.gPRS.item(i).timeOutFromMIR=timeOutAnswer;
        m.gPRS.item(i).currentCounter=2;
        m.gPRS.item(i).transferCondition=2;
        m.gPRS.item(i).transferData=openChannel.get(0,1);
        m.gPRS.item(i).GPRS.fireEvent("sendData");
       }
    }
}
]]></EntryAction></State>
<State ID="255" Name="Опрос параметров" Rect="-10 280 200 300" NamePos="40 280" InCables="224" OutCables="213">
<EntryAction><![CDATA[


if (parReqData == null)
{
//Engine.restart();
Engine.stop();
//Engine.showMessage("Задайте список опрашиваемых параметров","Внимание!!!",Engine.MESSAGE_INFORMATION, Engine.SHOW_AND_CONTINUE);
JOptionPane.showMessageDialog(Engine.getAnimation(),"Задайте список опрашиваемых параметров","Внимание!!!",JOptionPane.WARNING_MESSAGE);
}
else if (checkVector(parReqData))

{
//Engine.restart();
Engine.stop();
JOptionPane.showMessageDialog(Engine.getAnimation(),"Задайте список опрашиваемых параметров","Внимание!!!",JOptionPane.WARNING_MESSAGE);}

]]></EntryAction></State>
<State ID="256" Name="Открытие сеанса(запрос)" Rect="-10 160 200 180" NamePos="10 160" InCables="260" OutCables="226">
<EntryAction><![CDATA[
nextMIR=false;
model m = (model)getOwner();
if (currentChannel==1)
{
  for(int i=0;i<(m.parKolMasGSM.size()/2);i++)
    {
     if (ID==i)
       {
        m.gSM.item(i).transferData=openChannel.get(0,0);
        m.gSM.item(i).GSM.fireEvent("sendData");
       }
    }
}
else if (currentChannel==2)
{
 for(int i=0;i<(m.parKolMasGPRS.size()/2);i++)
    {
     if (ID==i)
       {
        m.gPRS.item(i).currentCounter=2;
        m.gPRS.item(i).transferCondition=1;
        m.gPRS.item(i).transferData=openChannel.get(0,0);
        m.gPRS.item(i).GPRS.fireEvent("sendData");
       }
    }
}
]]></EntryAction></State>
<State ID="257" Name="Конец опроса i-го CЭТ" Rect="360 470 570 490" NamePos="380 470" InCables="320 300" OutCables="231">
<ExitAction><![CDATA[
indexMIR++;
iArray = 0;
allIArray=false;


]]></ExitAction></State>
<State ID="15" Name="В этом канале МИРов нет" Rect="170 80 360 100" NamePos="190 80" InCables="11" OutCables="10">
<EntryAction><![CDATA[
allMIR = true;
 model m = (model)getOwner();
if (currentChannel==1)
{
 for(int i=0;i<(m.parKolMasGSM.size()/2);i++)
    {
     if (ID==i)
       {
         if (m.mIRGSM.item(i).allMIR & m.sETGSM.item(i).allSET)
             {
               m.mIRGSM.item(i).allMIR=false;
                  m.sETGSM.item(i).allSET=false;
                  m.gSM.item(i).GSM.fireEvent("callEND");
              }
          else
             {
               m.sETGSM.item(i).oprosAlgoritm.fireEvent("startSETGSM");
             }
       }
    }
}
else if (currentChannel==2)
{
 for(int i=0;i<(m.parKolMasGPRS.size()/2);i++)
    {
     if (ID==i)
       {
         if (m.mIRGPRS.item(i).allMIR & m.sETGPRS.item(i).allSET)
             {
               m.mIRGPRS.item(i).allMIR=false;
                  m.sETGPRS.item(i).allSET=false;
              model.kolFinishGPRS++;
              if (model.kolFinishGPRS==(model.parKolMasGPRS.size())/2)
                 {model.finishAllGPRS=true;
                 
                 }
             }
          else
             {
               m.sETGPRS.item(i).oprosAlgoritm.fireEvent("startSETGPRS");
             }
       }
    }
}
]]></EntryAction>
<ExitAction><![CDATA[

netMIR = false;
]]></ExitAction></State>
<State ID="16" Name="Ожидание" Rect="30 -30 130 -10" NamePos="50 -30" InCables="20 10 13" OutCables="316 9"/>
<State ID="19" Name="Начало" Rect="30 -70 130 -50" NamePos="50 -70" InCables="1" OutCables="13"/>
<State ID="14" Name="Закончен опрос МИРов" Rect="-190 160 -30 180" NamePos="-180 160" InCables="261" OutCables="20">
<ExitAction><![CDATA[


indexMIR = 1;

]]></ExitAction></State>
</Items></Statechart>
<Port ID="2" Name="port" Pos="-30 100" NamePos="-20 100" Parent="1"/>
<Bounds Flags="0" Pen="#808080 20" Brush="#000000" ID="1" Name="MIRC01" Rect="-30 -80 350 280" NamePos="-20 -70" Children="2"/>
<Comment ID="32" Name="textBox2" Rect="10 -40 160 110">
<Text><![CDATA[Вспомогательные переменные]]></Text></Comment>
<Comment ID="31" Name="textBox1" Rect="180 -40 330 260">
<Text><![CDATA[
Системные переменные

]]></Text></Comment>
<Comment ID="13" Name="textBox" Rect="10 130 160 260">
<Text><![CDATA[
Статистика

]]></Text></Comment>
</StructureDiagram><Image/>
<Equations><![CDATA[//8*[10,13,12,23,10,13,12,23]]]></Equations>
<Parameters>
<Item Name="bitrate" DefaultValue="9600" Modificator="2"/>
<Item Name="parReqData" Type="Vector" Modificator="2"/>
<Item Name="maxTimeoutAnswer" DefaultValue="1" Modificator="2"/>
<Item Name="verNoAnswer" DefaultValue="5" Modificator="2"/>
</Parameters></Item>
<Item Name="RADIO" Expanded="y">
<AdditionalClassCode><![CDATA[
boolean nextRADIOChannel,allRADIOChannel = false;
int indexRADIOChannel = 1;

boolean finishRADIO = false;
]]></AdditionalClassCode>
<StructureDiagram>
<Variable ID="5" Name="ID" Pos="80 20" NamePos="90 20">
<VarType ScalarType="integer"/>
<Value><![CDATA[0]]></Value>
<Equation/></Variable>
<Statechart ID="4" Name="RADIO" Pos="260 70" NamePos="270 70">
<Items>
<Initial ID="5" Name="pointer1" Target="16" Points="-80 -310 -80 -270"/>
<ChoicePoint ID="6" Name="branch" Pos="-80 -210" InCables="12" OutCables="10 11">
<Action><![CDATA[
if (indexRADIOChannel <= (model.parKolMasRADIO.size())/2)
{nextRADIOChannel = true;}
else 
{allRADIOChannel = true;}
]]></Action></ChoicePoint>
<Transition ID="17" Name="transition4" Source="13" Target="14" Points="10 50 50 50 50 -150" Type="1"/>
<Transition ID="7" Name="transition5" Source="14" Target="16" Points="110 -160 130 -160 130 -260 -60 -260" Type="1"/>
<Transition ID="9" Name="transition3" Source="15" Target="13" Points="-180 -150 -180 -10 -80 -10 -80 40" Type="2">
<Trigger><![CDATA[uniform(1,3)]]></Trigger></Transition>
<Transition ID="10" Name="transition2" Source="6" Target="14" Points="-70.3 -206.2 20 -170" Type="1">
<Guard><![CDATA[allRADIOChannel]]></Guard></Transition>
<Transition ID="11" Name="transition1" Source="6" Target="15" Points="-89.7 -206.2 -180 -170" Type="1">
<Guard><![CDATA[nextRADIOChannel]]></Guard></Transition>
<Transition ID="12" Name="transition" Source="16" Target="6" Points="-80 -250 -80 -220 -80 -220.5" Type="4">
<Trigger><![CDATA["startRADIO"]]></Trigger></Transition>
<State ID="13" Name="Следующий канал GSM" Rect="-170 40 10 60" NamePos="-150 40" InCables="9" OutCables="17">
<EntryAction><![CDATA[indexRADIOChannel++;]]></EntryAction></State>
<State ID="14" Name="Следующий тип канала" Rect="-70 -170 110 -150" NamePos="-60 -170" InCables="17 10" OutCables="7">
<EntryAction><![CDATA[
model.kolFinishRADIO++;
if (model.kolFinishRADIO==(model.parKolMasRADIO.size())/2)
{model.finishAllRADIO=true;}
]]></EntryAction>
<ExitAction><![CDATA[
allRADIOChannel = false;
indexRADIOChannel = 1;
]]></ExitAction></State>
<State ID="15" Name="Процедура соединения" Rect="-260 -170 -100 -150" NamePos="-250 -170" InCables="11" OutCables="9">
<ExitAction><![CDATA[nextRADIOChannel = false;]]></ExitAction></State>
<State ID="16" Name="Начало" Rect="-120 -270 -60 -250" NamePos="-110 -270" InCables="5 7" OutCables="12"/>
</Items></Statechart>
<Port ID="3" Name="portOut" Pos="400 100" NamePos="410 100" Parent="1"/>
<Port ID="2" Name="portIn" Pos="0 100" NamePos="10 100" Parent="1"/>
<Bounds Flags="0" Pen="#808080 20" Brush="#000000" ID="1" Name="RADIO" Rect="0 0 400 200" NamePos="10 10" Children="3 2"/>
</StructureDiagram><Image/></Item>
<Item Name="SET" Expanded="y">
<Import><![CDATA[import javax.swing.*;]]></Import>
<AdditionalClassCode><![CDATA[
boolean netSET,estSET,nextSET,allSET,openIs,closeIs,nextData,allData,SETwork,SETdontwork = false;
boolean estEvent,estEnergy,estPower, estDopPar, nextIArray,allIArray,someNo,oprosManyArray = false;
int indexArray = 1;
//int iArray = 0;
int indexEventJournal  = 1;
boolean noManyArray,estManyArray = false;

model exModel = (model)getOwner();
double getTimeOut(){
double i;
double meanDistr = (timeOutOfSpeed(bitrate) + (maxTimeoutAnswer - timeOutOfSpeed(bitrate))/2);
double sigmaDistr = maxTimeoutAnswer - meanDistr;
//timeOutAnswer = DistrNormal.sample(sigmaDistr,meanDistr);
i = DistrUniform.sample(timeOutOfSpeed(bitrate),maxTimeoutAnswer);
return i;
}

static boolean checkVector(Vector a){
boolean s = false;
int j = 0;
for (int i = 0;i<=a.size()-1;i++){
if (((Double)a.get(i)).doubleValue() != 0)
   j++;
}
if (j==0)
   s=true;
return s;
}

]]></AdditionalClassCode>
<ConversionTables>
<Item Name="timeOutOfSpeed" TransformationType="2" PolynomOrder="3" ArgOutOfRangeReactionType="2">
<RecordList>
<Record Arg="1200" Fun="0.049"/>
<Record Arg="2400" Fun="0.025"/>
<Record Arg="4800" Fun="0.013"/>
<Record Arg="9600" Fun="0.007"/>
</RecordList></Item>
</ConversionTables>
<StructureDiagram>
<ChartTimer ID="18" Name="timerTimeOut" Pos="210 30" NamePos="220 30" Timeout="1.0">
<ExpiryAction><![CDATA[oprosAlgoritm.fireEvent("nextStep");]]></ExpiryAction></ChartTimer>
<Variable ID="38" Name="iArray" Pos="250 300" NamePos="260 300">
<VarType ScalarType="integer"/>
<Value><![CDATA[0]]></Value>
<Equation/></Variable>
<Variable ID="35" Name="avTimeSETGSM" Pos="40 110" NamePos="50 110">
<VarType ScalarType="real"/>
<Equation/></Variable>
<Variable ID="34" Name="avTimeSETGPRS" Pos="40 90" NamePos="50 90">
<VarType ScalarType="real"/>
<Equation/></Variable>
<Variable ID="33" Name="closeChannelSET" Pos="40 130" NamePos="50 130">
<VarType ScalarType="real"/>
<Value><![CDATA[0]]></Value>
<Equation/></Variable>
<Variable ID="31" Name="timeScale" Pos="210 110" NamePos="220 109.9">
<VarType ScalarType="real"/>
<Value><![CDATA[60]]></Value>
<Equation/></Variable>
<Variable ID="29" Name="timeOutAnswer" Pos="210 270" NamePos="220 270">
<VarType ScalarType="real"/>
<Value><![CDATA[0]]></Value>
<Equation RightHandSide="DistrNormal.sample(0.05,0.15)"/></Variable>
<Variable ID="28" Name="ID" Pos="290 110" NamePos="300 110">
<VarType ScalarType="integer"/>
<Value><![CDATA[0]]></Value>
<Equation/></Variable>
<Variable ID="27" Name="currentChannel" Pos="40 290" NamePos="50 289.9">
<VarType ScalarType="integer"/>
<Value><![CDATA[0]]></Value>
<Equation/></Variable>
<Variable ID="24" Name="SETdontAnswer" Pos="40 160" NamePos="50 160">
<VarType ScalarType="integer"/>
<Value><![CDATA[0]]></Value>
<Equation/></Variable>
<Variable ID="17" Name="closeChannel" Pos="210 170" NamePos="220 170">
<VarType Sort="1" ScalarType="real" Rows="1" Columns="2"/>
<Value><![CDATA[8*[4,4]]]></Value>
<Equation Type="1" RightHandSide="8*[4,4]"/></Variable>
<Variable ID="16" Name="openChannel" Pos="210 150" NamePos="220 150">
<VarType Sort="1" ScalarType="real" Rows="1" Columns="2"/>
<Equation Type="1" RightHandSide="8*[10,4]"/></Variable>
<Variable ID="15" Name="testChannel" Pos="210 130" NamePos="220 130">
<VarType Sort="1" ScalarType="real" Rows="1" Columns="2"/>
<Equation Type="1" RightHandSide="8*[4,4]"/></Variable>
<Variable ID="14" Name="openCloseChannel" Pos="40 270" NamePos="50 270">
<VarType ScalarType="boolean"/>
<Value><![CDATA[false]]></Value>
<Equation/></Variable>
<Variable ID="11" Name="indexSET" Pos="40 250" NamePos="50 250">
<VarType ScalarType="real"/>
<Value><![CDATA[1]]></Value>
<Equation/></Variable>
<Variable ID="10" Name="arrayEventJournal" Pos="210 250" NamePos="220 250">
<VarType Sort="1" ScalarType="real" Rows="1" Columns="14"/>
<Equation Type="1" RightHandSide="8*[4,16,4,16,4,16,4,16,4,16,4,16,5,10]"/></Variable>
<Variable ID="9" Name="arrayParametrs" Pos="210 230" NamePos="220 230">
<VarType Sort="1" ScalarType="real" Rows="1" Columns="28"/>
<Equation Type="1" RightHandSide="8*[5,10,6,14,6,14,6,14,6,14,6,14,6,14,5,5,6,14,6,14,5,10,5,6,5,13,6,6]"/></Variable>
<Variable ID="8" Name="arrayEnergy" Pos="210 210" NamePos="220 210">
<VarType Sort="1" ScalarType="integer" Rows="1" Columns="2"/>
<Equation Type="1" RightHandSide="8*[6,19]"/></Variable>
<Variable ID="7" Name="arrayPowerProfile" Pos="210 190" NamePos="220 190">
<VarType Sort="1" ScalarType="integer" Rows="1" Columns="2"/>
<Equation Type="1" RightHandSide="8*[8,19]"/></Variable>
<Statechart ID="4" Name="oprosAlgoritm" Pos="90 30" NamePos="100 30">
<Items>
<Initial ID="4" Name="pointer" Target="2" Points="-120 -520 -120 -500"/>
<ChoicePoint ID="155" Name="branch6" Pos="-320 370" InCables="186" OutCables="161 156">
<Action><![CDATA[
if(randomTrue(verNoAnswer/100))
{SETdontwork=true;}
else
{SETwork=true;}
]]></Action></ChoicePoint>
<ChoicePoint ID="125" Name="branch5" Pos="-140 40" InCables="127" OutCables="207 206 205 202 143">
<Action><![CDATA[
if ( ((Double)parReqData.get(iArray)).doubleValue()==1 & iArray ==0 )
{estEvent = true;}
else if (((Double)parReqData.get(iArray)).doubleValue()==1 & iArray ==1)
{estEnergy = true;}
else if (((Double)parReqData.get(iArray)).doubleValue()==1 & iArray ==2)
{estPower = true;}
else if (((Double)parReqData.get(iArray)).doubleValue()==1 & iArray ==3)
{estDopPar = true;}
else 
{someNo = true;}
]]></Action></ChoicePoint>
<ChoicePoint ID="123" Name="branch4" Pos="-140 0" InCables="143 138 124" OutCables="170 127">
<Action><![CDATA[

if (iArray<=3)
{nextIArray=true;}
else
{allIArray=true;}

]]></Action></ChoicePoint>
<ChoicePoint ID="86" Name="branch2" Pos="-320 230" InCables="72" OutCables="145 90 89">
<Action><![CDATA[
if (iArray == 0)
{
   if (indexArray < arrayEventJournal.getColumnDimension()/2)
      {
    
      if (indexEventJournal< 10)
         {
          noManyArray = false;
          oprosManyArray=true;
          estManyArray = true;
         }
      else if(indexEventJournal == 10)
         { 
           oprosManyArray=true;
           
           noManyArray = true;
           estManyArray = false;
         }
      }
  
   
   else if (indexArray == arrayEventJournal.getColumnDimension()/2)
      {
       nextData = true;
        noManyArray = true;
      }
   else
      {allData = true;}
}




else if (iArray==1)
{
 if (indexArray <= arrayEnergy.getColumnDimension()/2)
      {nextData = true;
       noManyArray = true;
      }
   else
      {allData = true;}
}
else if (iArray==2)
{
 if (indexArray <= arrayPowerProfile.getColumnDimension()/2)
      {//nextData = true;
           if (indexEventJournal< 12)
          {
           noManyArray = false;
           oprosManyArray=true;
           estManyArray = true;
          }
       else if(indexEventJournal == 12)
         { 
           oprosManyArray=true;
           noManyArray = true;
           estManyArray = false;
         }
      
      }
   else
      {allData = true;}
}
else if (iArray==3)
{
 if (indexArray <= arrayParametrs.getColumnDimension()/2)
      {nextData = true;
   noManyArray = true;
      }
   else
      {allData = true;}
}
]]></Action></ChoicePoint>
<ChoicePoint ID="67" Name="branch3" Pos="-200 190" InCables="209 208 178 174 147 99" OutCables="73 72">
<Action><![CDATA[
if (openCloseChannel){
openIs = true;
}else
{closeIs = true;}
]]></Action></ChoicePoint>
<ChoicePoint ID="29" Name="branch1" Pos="-210 -340" InCables="173 20" OutCables="32 30">
<Action><![CDATA[
model m = (model)getOwner();
 estSET = false;
if (currentChannel==1)
   {
    if (indexSET <= ((Double)m.parKolMasGSM.get(2*ID)).doubleValue() )
       {nextSET =true;}
    else
       {allSET = true;}
   }
else if (currentChannel==2)
   {
    if (indexSET <= ((Double)m.parKolMasGPRS.get(2*ID)).doubleValue() )
       {nextSET =true;}
    else
       {allSET = true;}

   }

]]></Action></ChoicePoint>
<ChoicePoint ID="19" Name="branch" Pos="-120 -370" InCables="181 182" OutCables="21 20">
<Action><![CDATA[
model m = (model)getOwner();

if (currentChannel==1)
   {
    if (((Double)m.parKolMasGSM.get(2*ID)).doubleValue()== 0)
       {netSET=true;}
    else
       {estSET=true;}
   }
else if (currentChannel==2)
   {
    if (((Double)m.parKolMasGPRS.get(2*ID)).doubleValue()== 0)
       {netSET=true;}
    else
       {estSET=true;}
   }



 

//((Double)m.parKolMasGSM.get(2*(m.gSM.indexChannel-1)+1)).doubleValue()!=0
]]></Action></ChoicePoint>
<Transition ID="209" Name="transition33" Source="15" Target="67" Points="-110 110 -110 140 -190 140 -198 179.8" Type="1"/>
<Transition ID="208" Name="transition32" Source="16" Target="67" Points="-260 110 -260 140 -210 140 -202 179.8" Type="1"/>
<Transition ID="207" Name="transition30" Source="125" Target="17" Points="-149.3 44.6 -160 50 -420 50 -420 90" Type="1">
<Guard><![CDATA[estEvent]]></Guard></Transition>
<Transition ID="206" Name="transition31" Source="125" Target="16" Points="-143.3 49.9 -150 70 -260 70 -260 90" Type="1">
<Guard><![CDATA[estEnergy]]></Guard></Transition>
<Transition ID="205" Name="transition27" Source="125" Target="15" Points="-136.7 49.9 -130 70 -110 70 -110 70 -110 90" Type="1">
<Guard><![CDATA[estPower]]></Guard></Transition>
<Transition ID="202" Name="transition26" Source="125" Target="18" Points="-129.5 40 40 40 40 90" Type="1">
<Guard><![CDATA[estDopPar]]></Guard></Transition>
<Transition ID="201" Name="transition25" Source="60" Target="7" Points="-20 230 140 230 140 180 140 190 140 -120 140 -280 -70 -280" Type="1"/>
<Transition ID="199" Name="transition24" Source="200" Target="192" Points="260 100 260 120" Type="4">
<Trigger><![CDATA["nextStep"]]></Trigger></Transition>
<Transition ID="197" Name="transition16" Source="198" Target="70" Points="-320 450 -320 470" Type="4">
<Trigger><![CDATA["nextStep"]]></Trigger></Transition>
<Transition ID="195" Name="transition13" Source="196" Target="48" Points="-140 -110 -140 -90" Type="4">
<Trigger><![CDATA["nextStep"]]></Trigger></Transition>
<Transition ID="194" Name="transition12" Source="193" Target="40" Points="-140 -230 -140 -210" Type="4">
<Trigger><![CDATA["nextStep"]]></Trigger></Transition>
<Transition ID="189" Name="transition46" Source="191" Target="200" Points="260 60 260 80" Type="4">
<Trigger><![CDATA["receiveData"]]></Trigger></Transition>
<Transition ID="190" Name="transition10" Source="192" Target="9" Points="260 140 260 160" Type="4">
<Trigger><![CDATA["receiveData"]]></Trigger></Transition>
<Transition ID="188" Name="transition53" Source="70" Target="96" Points="-320 490 -320 510" Type="4">
<Trigger><![CDATA["receiveData"]]></Trigger></Transition>
<Transition ID="186" Name="transition52" Source="69" Target="155" Points="-320 340 -320 359.5" Type="4">
<Trigger><![CDATA["receiveData"]]></Trigger></Transition>
<Transition ID="179" Name="transition4" Source="22" Target="184" Points="-130 -440 -160 -420" Type="4">
<Trigger><![CDATA["startSETGSM"]]></Trigger></Transition>
<Transition ID="180" Name="transition49" Source="22" Target="183" Points="-110 -440 -80 -420" Type="4">
<Trigger><![CDATA["startSETGPRS"]]></Trigger></Transition>
<Transition ID="181" Name="transition50" Source="184" Target="19" Points="-160 -400 -128.4 -376.3" Type="4">
<Trigger><![CDATA["callOK"]]></Trigger></Transition>
<Transition ID="182" Name="transition51" Source="183" Target="19" Points="-80 -400 -111.6 -376.3" Type="1"/>
<Transition ID="178" Name="transition36" Source="18" Target="67" Points="40 110 40 140 -110 140 -190.9 185" Type="1"/>
<Transition ID="174" Name="transition21" Source="17" Target="67" Points="-420 110 -420 140 -270 140 -208.5 183.9" Type="1"/>
<Transition ID="173" Name="transition9" Source="9" Target="29" Points="360 170 390 170 390 -100 390 -300 -70 -300 -200 -337.2" Type="1"/>
<Transition ID="172" Name="transition48" Source="154" Target="9" Points="-230 410 -230 430 260 430 260 180" Type="1"/>
<Transition ID="170" Name="transition29" Source="123" Target="191" Points="-129.5 0 260 0 260 40" Type="1">
<Guard><![CDATA[allIArray]]></Guard></Transition>
<Transition ID="161" Name="transition44" Source="155" Target="154" Points="-309.5 370 -230 370 -230 390" Type="1">
<Guard><![CDATA[SETdontwork]]></Guard></Transition>
<Transition ID="156" Name="transition43" Source="155" Target="198" Points="-320 380.5 -320 430" Type="1">
<Guard><![CDATA[SETwork]]></Guard></Transition>
<Transition ID="149" Name="transition42" Source="148" Target="69" Points="-260 300 -320 320" Type="1"/>
<Transition ID="147" Name="transition41" Source="96" Target="67" Points="-390 520 -410 520 -410 220 -210.3 191.4" Type="8">
<Trigger><![CDATA[estManyArray == true]]></Trigger>
<Action><![CDATA[indexEventJournal++;]]></Action></Transition>
<Transition ID="145" Name="transition40" Source="86" Target="148" Points="-312.6 237.4 -270 280" Type="1">
<Guard><![CDATA[oprosManyArray]]></Guard></Transition>
<Transition ID="143" Name="transition39" Source="125" Target="123" Points="-150.5 40 -170 40 -190 30 -180 10 -150.1 2.5" Type="1">
<Guard><![CDATA[someNo]]></Guard>
<Action><![CDATA[
iArray++;
someNo = false;
]]></Action></Transition>
<Transition ID="138" Name="transition37" Source="88" Target="123" Points="-140 290 -140 570 -510 570 -510 0 -150.5 0" Type="1"/>
<Transition ID="127" Name="transition23" Source="123" Target="125" Points="-140 10.5 -140 29.5" Type="1">
<Guard><![CDATA[nextIArray]]></Guard>
<Action><![CDATA[nextIArray = false;]]></Action></Transition>
<Transition ID="124" Name="transition20" Source="14" Target="123" Points="-140 -30 -140 -10.5" Type="1"/>
<Transition ID="99" Name="transition28" Source="96" Target="67" Points="-320 530 -320 550 -470 550 -470 190 -210.5 190" Type="8">
<Trigger><![CDATA[
noManyArray == true
//"nextParam"
]]></Trigger>
<Action><![CDATA[
indexArray++;
indexEventJournal = 1;
]]></Action></Transition>
<Transition ID="90" Name="transition19" Source="86" Target="69" Points="-323.3 239.9 -350 320" Type="1">
<Guard><![CDATA[nextData]]></Guard></Transition>
<Transition ID="89" Name="transition18" Source="86" Target="88" Points="-309.8 232.2 -140 270" Type="1">
<Guard><![CDATA[allData]]></Guard></Transition>
<Transition ID="73" Name="transition17" Source="67" Target="60" Points="-189.8 192.3 -70 220" Type="1">
<Guard><![CDATA[closeIs]]></Guard></Transition>
<Transition ID="72" Name="transition22" Source="67" Target="86" Points="-209.9 193.3 -310.1 226.7" Type="1">
<Guard><![CDATA[openIs]]></Guard></Transition>
<Transition ID="55" Name="transition15" Source="48" Target="14" Points="-140 -70 -140 -50" Type="4">
<Trigger><![CDATA["receiveData"]]></Trigger></Transition>
<Transition ID="53" Name="transition14" Source="11" Target="196" Points="-140 -150 -140 -130" Type="4">
<Trigger><![CDATA["receiveData"]]></Trigger></Transition>
<Transition ID="46" Name="transition11" Source="40" Target="11" Points="-140 -190 -140 -170" Type="4">
<Trigger><![CDATA["receiveData"]]></Trigger></Transition>
<Transition ID="43" Name="transition8" Source="7" Target="193" Points="-140 -270 -140 -250" Type="4">
<Trigger><![CDATA["receiveData"]]></Trigger></Transition>
<Transition ID="37" Name="transition7" Source="31" Target="22" Points="-390 -280 -420 -280 -420 -450 -170 -450" Type="1">
<Action><![CDATA[
model m = (model)getOwner();
if (currentChannel==1)
{
 for(int i=0;i<m.parKolMasGSM.size()/2;i++)
    {
     if (ID==i)
       { 
        if (m.mIRGSM.item(i).allMIR & m.sETGSM.item(i).allSET)
        { 
          m.mIRGSM.item(i).allMIR=false;
          m.sETGSM.item(i).allSET=false;
          m.gSM.item(i).GSM.fireEvent("callEND");
       /*   model.kolFinishGSM++;
         if (model.kolFinishGSM==(model.parKolMasGSM.size())/2)
         {
         m.gSM.item(i).GSM.fireEvent("callEND");
         //model.finishAllGSM=true;
         }*/
        }
        else if (m.mIRGSM.item(i).allMIR==false & m.sETGSM.item(i).allSET==true)
        {
        m.mIRGSM.item(i).oprosAlgoritm.fireEvent("startMIRGSM");
        }
       }
    }
}
else if (currentChannel==2)
{
   

for(int i=0;i<m.parKolMasGPRS.size()/2;i++)
    {
     if (ID==i)
       { 
        if (m.mIRGPRS.item(i).allMIR & m.sETGPRS.item(i).allSET)
        { 
          m.mIRGPRS.item(i).allMIR=false;
          m.sETGPRS.item(i).allSET=false;
          model.kolFinishGPRS++;
          if (model.kolFinishGPRS==(model.parKolMasGPRS.size())/2)
             {model.finishAllGPRS=true;}
        }
        else if (m.mIRGPRS.item(i).allMIR==false & m.sETGPRS.item(i).allSET==true)
        {
        m.mIRGPRS.item(i).oprosAlgoritm.fireEvent("startMIRGPRS");
        }
       }
    }
}
]]></Action></Transition>
<Transition ID="32" Name="transition6" Source="29" Target="31" Points="-219.5 -335.7 -320 -290" Type="1">
<Guard><![CDATA[allSET]]></Guard></Transition>
<Transition ID="30" Name="transition5" Source="29" Target="7" Points="-202 -333.3 -150 -290" Type="1">
<Guard><![CDATA[nextSET]]></Guard></Transition>
<Transition ID="26" Name="transition3" Source="24" Target="22" Points="60 -350 60 -400 60 -450 -70 -450" Type="1"/>
<Transition ID="21" Name="transition2" Source="19" Target="24" Points="-110.1 -366.7 -30 -340" Type="1">
<Guard><![CDATA[netSET]]></Guard></Transition>
<Transition ID="20" Name="transition1" Source="19" Target="29" Points="-129.9 -366.7 -200.1 -343.3" Type="1">
<Guard><![CDATA[estSET]]></Guard></Transition>
<Transition ID="8" Name="transition" Source="2" Target="22" Points="-120 -480 -120 -460" Type="1"/>
<State ID="200" Name="Тайм-аут ответа3" Rect="150 80 360 100" NamePos="200 80" InCables="189" OutCables="199">
<EntryAction><![CDATA[
timeOutAnswer=getTimeOut();
//timerTimeOut.restart(timeOutAnswer/timeScale);
//timerTimeOut.restart(timeOutAnswer);
timerTimeOut.restart(0);
]]></EntryAction></State>
<State ID="198" Name="Тайм-аут ответа2" Rect="-390 430 -250 450" NamePos="-370 430" InCables="156" OutCables="197">
<EntryAction><![CDATA[
timeOutAnswer=getTimeOut();
timerTimeOut.restart(0);
]]></EntryAction></State>
<State ID="196" Name="Тайм-аут ответа1" Rect="-250 -130 -40 -110" NamePos="-190 -130" InCables="53" OutCables="195">
<EntryAction><![CDATA[
timeOutAnswer=getTimeOut();
  //timerTimeOut.restart(timeOutAnswer/timeScale);
//timerTimeOut.restart(timeOutAnswer);
timerTimeOut.restart(0);
]]></EntryAction></State>
<State ID="193" Name="Тайм-аут ответа" Rect="-220 -250 -70 -230" NamePos="-200 -250" InCables="43" OutCables="194">
<EntryAction><![CDATA[
timeOutAnswer=getTimeOut();
//timerTimeOut.restart(timeOutAnswer/timeScale);
//timerTimeOut.restart(timeOutAnswer);
timerTimeOut.restart(0);
]]></EntryAction></State>
<State ID="191" Name="Закрытие сеанса(запрос)" Rect="150 40 360 60" NamePos="170 40" InCables="170" OutCables="189">
<EntryAction><![CDATA[
model m = (model)getOwner();
if (currentChannel==1)
{
  for(int i=0;i<(m.parKolMasGSM.size()/2);i++)
    {
     if (ID==i)
       {
        m.gSM.item(i).transferData=closeChannel.get(0,0);
        m.gSM.item(i).GSM.fireEvent("sendData");
       }
    }
}
else if (currentChannel==2)
{
 for(int i=0;i<(m.parKolMasGPRS.size()/2);i++)
    {
     if (ID==i)
       {
        m.gPRS.item(i).currentCounter=1;
        m.gPRS.item(i).transferCondition=1;
        m.gPRS.item(i).transferData=closeChannel.get(0,0);
        m.gPRS.item(i).GPRS.fireEvent("sendData");
       }
    }
}
]]></EntryAction></State>
<State ID="192" Name="Закрытие сеанса(ответ)" Rect="150 120 360 140" NamePos="170 120" InCables="199" OutCables="190">
<EntryAction><![CDATA[
model m = (model)getOwner();
if (currentChannel==1)
{
  for(int i=0;i<(m.parKolMasGSM.size()/2);i++)
    {
     if (ID==i)
       {
        m.gSM.item(i).timeOutFromSET=timeOutAnswer;
        m.gSM.item(i).transferData=closeChannel.get(0,1);
        m.gSM.item(i).GSM.fireEvent("sendData");
       }
    }
}
else if (currentChannel==2)
{
 for(int i=0;i<(m.parKolMasGPRS.size()/2);i++)
    {
     if (ID==i)
       {
        m.gPRS.item(i).timeOutFromSET=timeOutAnswer;
        m.gPRS.item(i).currentCounter=1;
        m.gPRS.item(i).transferCondition=2;
        m.gPRS.item(i).transferData=closeChannel.get(0,1);
        m.gPRS.item(i).GPRS.fireEvent("sendData");
       }
    }
}
openCloseChannel=false;
]]></EntryAction></State>
<State ID="183" Name="по GPRS" Rect="-110 -420 -50 -400" NamePos="-100 -420" InCables="180" OutCables="182">
<EntryAction><![CDATA[currentChannel=2;]]></EntryAction></State>
<State ID="184" Name="по GSM" Rect="-190 -420 -130 -400" NamePos="-180 -420" InCables="179" OutCables="181">
<EntryAction><![CDATA[
currentChannel=1;
model m = (model)getOwner();
for(int i=0;i<(m.parKolMasGSM.size()/2);i++)
{
     if (ID==i)
       {
        m.gSM.item(i).currentCounter=1;
        if (m.gSM.item(i).statusCalling==false)
           {m.gSM.item(i).GSM.fireEvent("startGSM");}
        else if (m.gSM.item(i).statusCalling)
           {this.fireEvent("callOK");}
        
        
       }
}


]]></EntryAction></State>
<State ID="154" Name="Счётчик не отвечает" Rect="-300 390 -150 410" NamePos="-290 390" InCables="161" OutCables="172">
<EntryAction><![CDATA[
SETdontwork = false;
SETdontAnswer++;
]]></EntryAction>
<ExitAction><![CDATA[
indexArray = 1;
indexEventJournal = 1;
]]></ExitAction></State>
<State ID="148" Name="Ещё массив" Rect="-310 280 -220 300" NamePos="-300 280" InCables="145" OutCables="149">
<ExitAction><![CDATA[oprosManyArray = false;]]></ExitAction></State>
<State ID="96" Name="След. параметр" Rect="-390 510 -250 530" NamePos="-370 510" InCables="188" OutCables="147 99"/>
<State ID="88" Name="След. массив" Rect="-200 270 -90 290" NamePos="-190 270" InCables="89" OutCables="138">
<ExitAction><![CDATA[
allData = false;
indexArray = 1;
iArray++;
]]></ExitAction></State>
<State ID="70" Name="Отправка ответа" Rect="-390 470 -250 490" NamePos="-370 470" InCables="197" OutCables="188">
<EntryAction><![CDATA[
model m = (model)getOwner();
if (currentChannel==1)
{
for(int i=0;i<(m.parKolMasGSM.size()/2);i++)
    {
     if (ID==i)
       {
        if (iArray == 0)
        {
          m.gSM.item(i).transferData=arrayEventJournal.get(0,2*(indexArray-1)+1);
        }
        else if (iArray==1)
        {
          m.gSM.item(i).transferData=arrayEnergy.get(0,2*(indexArray-1)+1);
        }
        else if (iArray==2)
        {
          m.gSM.item(i).transferData=arrayPowerProfile.get(0,2*(indexArray-1)+1);
        }
        else if (iArray==3)
        {
          m.gSM.item(i).transferData=arrayParametrs.get(0,2*(indexArray-1)+1);
        }
        m.gSM.item(i).timeOutFromSET=timeOutAnswer;
        m.gSM.item(i).GSM.fireEvent("sendData");
       }
    }
}
else if (currentChannel==2)
{
 for(int i=0;i<(m.parKolMasGPRS.size()/2);i++)
    {
     if (ID==i)
       {
        if (iArray == 0)
        {
          m.gPRS.item(i).transferData=arrayEventJournal.get(0,2*(indexArray-1)+1);
        }
        else if (iArray==1)
        {
          m.gPRS.item(i).transferData=arrayEnergy.get(0,2*(indexArray-1)+1);
        }
        else if (iArray==2)
        {
          m.gPRS.item(i).transferData=arrayPowerProfile.get(0,2*(indexArray-1)+1);
        }
        else if (iArray==3)
        {
          m.gPRS.item(i).transferData=arrayParametrs.get(0,2*(indexArray-1)+1);
        }
        m.gPRS.item(i).timeOutFromSET=timeOutAnswer;
        m.gPRS.item(i).currentCounter=1;
        m.gPRS.item(i).transferCondition=2;
        m.gPRS.item(i).GPRS.fireEvent("sendData");
       }
    }
}
]]></EntryAction>
<ExitAction><![CDATA[SETwork = false;]]></ExitAction></State>
<State ID="69" Name="Получение запроса" Rect="-390 320 -240 340" NamePos="-370 320" InCables="149 90" OutCables="186">
<EntryAction><![CDATA[
model m = (model)getOwner();
if (currentChannel==1)
{
 for(int i=0;i<(m.parKolMasGSM.size()/2);i++)
    {
     if (ID==i)
       {
        if (iArray == 0)
        {
          m.gSM.item(i).transferData=arrayEventJournal.get(0,2*(indexArray-1));
        }
        else if (iArray==1)
        {
          m.gSM.item(i).transferData=arrayEnergy.get(0,2*(indexArray-1));
        }
        else if (iArray==2)
        {
          m.gSM.item(i).transferData=arrayPowerProfile.get(0,2*(indexArray-1));
        }
        else if (iArray==3)
        {
          m.gSM.item(i).transferData=arrayParametrs.get(0,2*(indexArray-1));
        }
        m.gSM.item(i).GSM.fireEvent("sendData");
       }
    }
}
else if (currentChannel==2)
{
 for(int i=0;i<(m.parKolMasGPRS.size()/2);i++)
    {
     if (ID==i)
       {
        if (iArray == 0)
        {
          m.gPRS.item(i).transferData=arrayEventJournal.get(0,2*(indexArray-1));
        }
        else if (iArray==1)
        {
          m.gPRS.item(i).transferData=arrayEnergy.get(0,2*(indexArray-1));
        }
        else if (iArray==2)
        {
          m.gPRS.item(i).transferData=arrayPowerProfile.get(0,2*(indexArray-1));
        }
        else if (iArray==3)
        {
          m.gPRS.item(i).transferData=arrayParametrs.get(0,2*(indexArray-1));
        }
        m.gPRS.item(i).currentCounter=1;
        m.gPRS.item(i).transferCondition=1;
        m.gPRS.item(i).GPRS.fireEvent("sendData");
       }
    }
}
openCloseChannel = true;

]]></EntryAction>
<ExitAction><![CDATA[

 nextData = false;
]]></ExitAction></State>
<State ID="60" Name="Канал закрыт" Rect="-130 220 -20 240" NamePos="-120 220" InCables="73" OutCables="201">
<EntryAction><![CDATA[closeChannelSET++;]]></EntryAction>
<ExitAction><![CDATA[closeIs = false;]]></ExitAction></State>
<State ID="48" Name="Открытие сеанса(ответ)" Rect="-250 -90 -40 -70" NamePos="-230 -90" InCables="195" OutCables="55">
<EntryAction><![CDATA[
openCloseChannel = true;
model m = (model)getOwner();
if (currentChannel==1)
{
 for(int i=0;i<(m.parKolMasGSM.size()/2);i++)
    {
     if (ID==i)
       {
        m.gSM.item(i).timeOutFromSET=timeOutAnswer;
        m.gSM.item(i).transferData=openChannel.get(0,1);
        m.gSM.item(i).GSM.fireEvent("sendData");
       }
    }
}
else if (currentChannel==2)
{
 for(int i=0;i<(m.parKolMasGPRS.size()/2);i++)
    {
     if (ID==i)
       {
        m.gPRS.item(i).timeOutFromSET=timeOutAnswer;
        m.gPRS.item(i).currentCounter=1;
        m.gPRS.item(i).transferCondition=2;
        m.gPRS.item(i).transferData=openChannel.get(0,1);
        m.gPRS.item(i).GPRS.fireEvent("sendData");
       }
    }
}


]]></EntryAction></State>
<State ID="40" Name="Тест канала(ответ)" Rect="-220 -210 -70 -190" NamePos="-200 -210" InCables="194" OutCables="46">
<EntryAction><![CDATA[
model m = (model)getOwner();
if (currentChannel==1)
{
  for(int i=0;i<(m.parKolMasGSM.size()/2);i++)
    {
     if (ID==i)
       {
        m.gSM.item(i).timeOutFromSET=timeOutAnswer;
        m.gSM.item(i).transferData=testChannel.get(0,1);
        m.gSM.item(i).GSM.fireEvent("sendData");
       }
    }
}
else if (currentChannel==2)
{
 for(int i=0;i<(m.parKolMasGPRS.size()/2);i++)
    {
     if (ID==i)
       {
        m.gPRS.item(i).timeOutFromSET=timeOutAnswer;
        m.gPRS.item(i).currentCounter=1;
        m.gPRS.item(i).transferCondition=2;
        m.gPRS.item(i).transferData=testChannel.get(0,1);
        m.gPRS.item(i).GPRS.fireEvent("sendData");
       }
    }
}
]]></EntryAction></State>
<State ID="31" Name="Закончен опрос СЭТов" Rect="-390 -290 -230 -270" NamePos="-380 -290" InCables="32" OutCables="37">
<ExitAction><![CDATA[


 indexSET = 1;

]]></ExitAction></State>
<State ID="24" Name="В этом канале СЭТов нет" Rect="-30 -350 160 -330" NamePos="-10 -350" InCables="21" OutCables="26">
<EntryAction><![CDATA[
allSET = true;
 model m = (model)getOwner();
if (currentChannel==1)
{
 for(int i=0;i<(m.parKolMasGSM.size()/2);i++)
    {
     if (ID==i)
       {
        if (m.mIRGSM.item(i).allMIR & m.sETGSM.item(i).allSET)
       { 
         m.mIRGSM.item(i).allMIR=false;
         m.sETGSM.item(i).allSET=false;
         m.gSM.item(i).GSM.fireEvent("callEND");
       }
       else
       {
        m.mIRGSM.item(i).oprosAlgoritm.fireEvent("startMIRGSM");
       }
       }
    } 
}
else if (currentChannel==2)
{
 for(int i=0;i<(m.parKolMasGPRS.size()/2);i++)
    {
     if (ID==i)
       {
        if (m.mIRGPRS.item(i).allMIR & m.sETGPRS.item(i).allSET)
       { 
              m.mIRGPRS.item(i).allMIR=false;
                  m.sETGPRS.item(i).allSET=false;
         model.kolFinishGPRS++;
         if (model.kolFinishGPRS==(model.parKolMasGPRS.size())/2)
        {model.finishAllGPRS=true;
      }
       }
       else
       {
        m.mIRGPRS.item(i).oprosAlgoritm.fireEvent("startMIRGPRS");
       }
       }
    }
}
]]></EntryAction>
<ExitAction><![CDATA[netSET = false;]]></ExitAction></State>
<State ID="22" Name="Ожидание" Rect="-170 -460 -70 -440" NamePos="-150 -460" InCables="37 26 8" OutCables="179 180"/>
<State ID="18" Name="Доп. параметры" Rect="-30 90 110 110" NamePos="-10 90" InCables="202" OutCables="178">
<ExitAction><![CDATA[estDopPar = false;]]></ExitAction></State>
<State ID="17" Name="Журнал событий" Rect="-490 90 -340 110" NamePos="-470 90" InCables="207" OutCables="174">
<ExitAction><![CDATA[estEvent = false;]]></ExitAction></State>
<State ID="16" Name="Энергия за сутки" Rect="-330 90 -190 110" NamePos="-310 90" InCables="206" OutCables="208">
<ExitAction><![CDATA[estEnergy = false;]]></ExitAction></State>
<State ID="15" Name="Срезы мощности" Rect="-180 90 -40 110" NamePos="-160 90" InCables="205" OutCables="209">
<ExitAction><![CDATA[estPower = false;]]></ExitAction></State>
<State ID="14" Name="Опрос параметров" Rect="-250 -50 -40 -30" NamePos="-200 -50" InCables="55" OutCables="124">
<EntryAction><![CDATA[


if (parReqData == null)
{
//Engine.restart();
Engine.stop();
//Engine.showMessage("Задайте список опрашиваемых параметров","Внимание!!!",Engine.MESSAGE_INFORMATION, Engine.SHOW_AND_CONTINUE);
JOptionPane.showMessageDialog(Engine.getAnimation(),"Задайте список опрашиваемых параметров","Внимание!!!",JOptionPane.WARNING_MESSAGE);
}
else if (checkVector(parReqData))

{
//Engine.restart();
Engine.stop();
JOptionPane.showMessageDialog(Engine.getAnimation(),"Задайте список опрашиваемых параметров","Внимание!!!",JOptionPane.WARNING_MESSAGE);}

]]></EntryAction></State>
<State ID="11" Name="Открытие сеанса(запрос)" Rect="-250 -170 -40 -150" NamePos="-230 -170" InCables="46" OutCables="53">
<EntryAction><![CDATA[
model m = (model)getOwner();
if (currentChannel==1)
{
 for(int i=0;i<(m.parKolMasGSM.size()/2);i++)
    {
     if (ID==i)
       {
        m.gSM.item(i).transferData=openChannel.get(0,0);
        m.gSM.item(i).GSM.fireEvent("sendData");
       }
    }
}
else if (currentChannel==2)
{
 for(int i=0;i<(m.parKolMasGPRS.size()/2);i++)
    {
     if (ID==i)
       {
        m.gPRS.item(i).currentCounter=1;
        m.gPRS.item(i).transferCondition=1;
        m.gPRS.item(i).transferData=openChannel.get(0,0);
        m.gPRS.item(i).GPRS.fireEvent("sendData");
       }
    }
}
]]></EntryAction></State>
<State ID="9" Name="Конец опроса i-го CЭТ" Rect="150 160 360 180" NamePos="170 160" InCables="190 172" OutCables="173">
<ExitAction><![CDATA[
indexSET++;
iArray = 0;
 allIArray = false;
]]></ExitAction></State>
<State ID="7" Name="Тест канала(запрос)" Rect="-220 -290 -70 -270" NamePos="-210 -290" InCables="201 30" OutCables="43">
<EntryAction><![CDATA[
model m = (model)getOwner();
if (currentChannel==1)
{
 for(int i=0;i<(m.parKolMasGSM.size()/2);i++)
    {
     if (ID==i)
       {
        m.gSM.item(i).transferData=testChannel.get(0,0);
        m.gSM.item(i).GSM.fireEvent("sendData");
       }
    }

}
else if (currentChannel==2)
{
 for(int i=0;i<(m.parKolMasGPRS.size()/2);i++)
    {
     if (ID==i)
       {
        m.gPRS.item(i).currentCounter=1;
        m.gPRS.item(i).transferCondition=1;
        m.gPRS.item(i).transferData=testChannel.get(0,0);
        m.gPRS.item(i).GPRS.fireEvent("sendData");
       }
    }
}
]]></EntryAction>
<ExitAction><![CDATA[nextSET=false;]]></ExitAction></State>
<State ID="2" Name="Начало" Rect="-170 -500 -70 -480" NamePos="-140 -500" InCables="4" OutCables="8"/>
<Comment ID="50" Name="textBox" Rect="-50 -290 -50 -160"/>
</Items></Statechart>
<Port ID="3" Name="port" Pos="-10 170" NamePos="0 170" Parent="1"/>
<Bounds Flags="0" Pen="#808080 20" Brush="#000000" ID="1" Name="SET" Rect="-10 10 360 330" NamePos="0 20" Children="3"/>
<Comment ID="37" Name="textBox3" Rect="190 50 340 310">
<Text><![CDATA[Системные переменные]]></Text></Comment>
<Comment ID="36" Name="textBox2" Rect="20 190 170 310">
<Text><![CDATA[Вспомогательные переменные]]></Text></Comment>
<Comment ID="23" Name="textBox1" Rect="20 50 170 170">
<Text><![CDATA[Статистика]]></Text></Comment>
</StructureDiagram><Image/>
<Parameters>
<Item Name="bitrate" DefaultValue="9600" Modificator="2"/>
<Item Name="parReqData" Type="Vector" Modificator="2"/>
<Item Name="maxTimeoutAnswer" DefaultValue="0.1" Modificator="2"/>
<Item Name="verNoAnswer" DefaultValue="5" Modificator="2"/>
</Parameters></Item>
<Item Name="model" Expanded="y">
<Import><![CDATA[
import interfaceMod.*;
import com.xj.anylogic.*;
import java.awt.*;
import javax.swing.*;
]]></Import>
<AdditionalClassCode><![CDATA[
double avKolEndGSM=0;
double avKolNeudachGSM=0;
double avKolRepeatGPRS=0;

double avKolDontAnsSET=0;
double avKolDontAnsMIR=0;
  
double avKolDontAnsSETG=0;
double avKolDontAnsMIRG=0;

public static Vector kolDataGPRS = new Vector();
public static double allDataGPRS=0;

public static boolean finishAllGSM=false;
public static int kolFinishGSM=0;

public static int kolFinishGPRS=0;
public static boolean finishAllGPRS=false;

public static int kolFinishRADIO=0;
public static boolean finishAllRADIO=false;

boolean stopChannel,waitChannel = false;
boolean nextChannel,otherChannel = false;

public static int scale = 3600;
public static Matrix askChannel = new Matrix(1,3);

void GSMCreate(int kolGSM){// создание заданого количества GSM каналов
 for (int i =0;i < kolGSM;i++)
     {
      this.setup_gSM(new GSM(),i);
      this.gSM.item(i).ID = i;
     }
}
void MIRcreateForGSM(int kolMIR){// функция создания заданого количества счётчиков МИР для GPRS каналов
 for (int i =0;i < kolMIR;i++)
     {
      this.setup_mIRGSM(new MIRC01(),i);
      this.mIRGSM.item(i).ID = i;
     }
}
void SETcreateForGSM(int kolSET){// функция создания заданого количества счётчиков МИР для GPRS каналов
 for (int i =0;i < kolSET;i++)
     {
      this.setup_sETGSM(new SET(),i);
      this.sETGSM.item(i).ID = i;
     }
}
void GPRSCreate(int kolGPRS){// создание заданого количества GPRS каналов
 for (int i =0;i < kolGPRS;i++)
     {
      this.setup_gPRS(new GPRS(),i);
      this.gPRS.item(i).ID = i;
     }

}
/*void RADIOCreate(int kolRADIO){// создание заданого количества GPRS каналов
 for (int i =0;i < kolRADIO;i++)
     {
      this.setup_rADIO(new RADIO(),i);
      this.rADIO.item(i).ID = i;
     }

}*/

void MIRcreateForGPRS(int kolMIR){// функция создания заданого количества счётчиков МИР для GPRS каналов
 for (int i =0;i < kolMIR;i++)
     {
      this.setup_mIRGPRS(new MIRC01(),i);
      this.mIRGPRS.item(i).ID = i;
     }
}
void SETcreateForGPRS(int kolSET){// функция создания заданого количества счётчиков МИР для GPRS каналов
 for (int i =0;i < kolSET;i++)
     {
      this.setup_sETGPRS(new SET(),i);
      this.sETGPRS.item(i).ID = i;
     }
}
//void breakResult(){
//}
void collectionStat(){
if (parKolMasGPRS!=null)
{
   if (parKolMasGPRS.size()==1)
   {
    avKolDontAnsSETG=sETGPRS.item(0).SETdontAnswer;
    avKolDontAnsMIRG=mIRGPRS.item(0).MIRdontAnswer;
   } 
    double sumKolRepeatGPRS=0;
    double sumKolDontSETG=0;
    double sumKolDontMIRG=0;
 for (int i = 0; i<parKolMasGPRS.size()/2;i++)
 { 
  kolDataGPRS.addElement(new Double((gPRS.item(i).kolData)/8192));
  allDataGPRS=allDataGPRS+gPRS.item(i).kolData;

  sumKolRepeatGPRS=sumKolRepeatGPRS+gPRS.item(i).kolRepeat;
  sumKolDontSETG=sumKolDontSETG+sETGPRS.item(i).SETdontAnswer;
  sumKolDontMIRG=sumKolDontMIRG+mIRGPRS.item(i).MIRdontAnswer;

   double sumVrOprosa=0;
   for (int j = 0; j<gPRS.item(i).VrOprosaGPRS.size();j++)
   {
    sumVrOprosa=sumVrOprosa+((Number)gPRS.item(i).VrOprosaGPRS.elementAt(j)).doubleValue();
   }
   // interfaceMod.Frame1.transferVrGPRS.addElement(new Double((sumVrOprosa/(gPRS.item(i).VrOprosaGPRS.size()))/60));
   double sumTimeSET=0;
   double sumTimeMIR=0;
   for (int k = 0; k<gPRS.item(i).avTimeSET.size();k++)
   {
    sumTimeSET=sumTimeSET+((Number)gPRS.item(i).avTimeSET.elementAt(k)).doubleValue();
    sumTimeMIR=sumTimeMIR+((Number)gPRS.item(i).avTimeMIR.elementAt(k)).doubleValue();
   }
   //interfaceMod.Frame1.transferTimeSETGPRS.addElement(new Double((sumTimeSET/(gPRS.item(i).avTimeSET.size()))/60));
   //interfaceMod.Frame1.transferTimeMIRGPRS.addElement(new Double((sumTimeMIR/(gPRS.item(i).avTimeMIR.size()))/60));
 }
  avKolRepeatGPRS=sumKolRepeatGPRS/(parKolMasGPRS.size()/2);
  avKolDontAnsSETG=sumKolDontSETG/(parKolMasGPRS.size()/2);
  avKolDontAnsMIRG=sumKolDontMIRG/(parKolMasGPRS.size()/2);
}
if (parKolMasGSM!=null)
{
   if (parKolMasGSM.size()==1)
   {
    avKolEndGSM=gSM.item(0).kolEndGSM;
    avKolNeudachGSM=gSM.item(0).kolNeudach;
   
    avKolDontAnsSET=sETGSM.item(0).SETdontAnswer;
    avKolDontAnsMIR=mIRGSM.item(0).MIRdontAnswer;
   } 

    double sumKolEndGSM=0;
    double sumKolNeudachGSM=0;

    double sumKolDontSET=0;
    double sumKolDontMIR=0;
   for (int i = 0; i<parKolMasGSM.size()/2;i++)
 {
  sumKolEndGSM= sumKolEndGSM+gSM.item(i).kolEndGSM;
  sumKolNeudachGSM= sumKolNeudachGSM+gSM.item(i).kolNeudach;
  sumKolDontSET=sumKolDontSET+sETGSM.item(i).SETdontAnswer;
  sumKolDontMIR=sumKolDontMIR+mIRGSM.item(i).MIRdontAnswer;
  double sumTimeUst=0;
  double sumTimeEnd=0;
  for (int s = 0; s<gSM.item(i).vrUst.size();s++)
   {
    sumTimeUst=sumTimeUst+((Number)gSM.item(i).vrUst.elementAt(s)).doubleValue();
    sumTimeEnd=sumTimeEnd+((Number)gSM.item(i).vrEnd.elementAt(s)).doubleValue();
   }
   // interfaceMod.Frame1.transferTimeUstGSM.addElement(new Double((sumTimeUst/(gSM.item(i).vrUst.size()))/60));
   // interfaceMod.Frame1.transferTimeEndGSM.addElement(new Double((sumTimeEnd/(gSM.item(i).vrEnd.size()))/60));
  double sumVrOprosa=0;
  for (int j = 0; j<gSM.item(i).VrOprosaGSM.size();j++)
   {
    sumVrOprosa=sumVrOprosa+((Number)gSM.item(i).VrOprosaGSM.elementAt(j)).doubleValue();
   }
   // interfaceMod.Frame1.transferVrGSM.addElement(new Double((sumVrOprosa/(gSM.item(i).VrOprosaGSM.size()))/60));
  double sumTimeSET=0;
  double sumTimeMIR=0;
  for (int k = 0; k<gSM.item(i).avTimeSET.size();k++)
   {
    sumTimeSET=sumTimeSET+((Number)gSM.item(i).avTimeSET.elementAt(k)).doubleValue();
    sumTimeMIR=sumTimeMIR+((Number)gSM.item(i).avTimeMIR.elementAt(k)).doubleValue();
   }
   //interfaceMod.Frame1.transferTimeSETGSM.addElement(new Double((sumTimeSET/(gSM.item(i).avTimeSET.size()))/60));
   //interfaceMod.Frame1.transferTimeMIRGSM.addElement(new Double((sumTimeMIR/(gSM.item(i).avTimeMIR.size()))/60));
 }
 avKolEndGSM=sumKolEndGSM/(parKolMasGSM.size()/2);
 avKolNeudachGSM=sumKolNeudachGSM/(parKolMasGSM.size()/2);
 avKolDontAnsSET=sumKolDontSET/(parKolMasGSM.size()/2);
 avKolDontAnsMIR=sumKolDontMIR/(parKolMasGSM.size()/2);
}
 //interfaceMod.Frame1.transferDataGPRS=kolDataGPRS;
}
void outputResult(){
//interfaceMod.Frame1.outKolNeudachGSM.setValue(new Double(Math.round(avKolNeudachGSM)));
//interfaceMod.Frame1.outKolEndGSM.setValue(new Double(Math.round(avKolEndGSM)));
//interfaceMod.Frame1.outAllDataGPRS.setValue(new Double(allDataGPRS/8192));
//interfaceMod.Frame1.outErrorGPRS.setValue(new Double(Math.round(avKolRepeatGPRS)));
//interfaceMod.Frame1.noAnswerMIR.setValue(new Double(Math.round(avKolDontAnsMIR)));
//interfaceMod.Frame1.noAnswerSET.setValue(new Double(Math.round(avKolDontAnsSET)));
//interfaceMod.Frame1.noAnswerMIRG.setValue(new Double(Math.round(avKolDontAnsMIRG)));
//interfaceMod.Frame1.noAnswerSETG.setValue(new Double(Math.round(avKolDontAnsSETG)));
}












]]></AdditionalClassCode>
<Animations>
<Item Name="modeling" Expanded="y">
<AnimationDiagram>
<Area ID="1" Rect="-320 -300 170 -50" ShapeColor="#d2ecff"/>
<Button Flags="6" Brush="#cccccc" ID="72" Name="button6" Rect="20 -280 160 -250" Font="Tahoma,12" Label="References">
<EventHandlingCode><![CDATA[

dcfgMod win3 = new dcfgMod(Engine.getAnimationFrame(),"ccc", true);
boolean packFrame = false;
  if (packFrame) {
      win3.pack();
    }
    else {
      win3.validate();
    }
    //Center the window
    Dimension screenSize = Toolkit.getDefaultToolkit().getScreenSize();
    Dimension frameSize = win3.getSize();
    if (frameSize.height > screenSize.height) {
      frameSize.height = screenSize.height;
    }
    if (frameSize.width > screenSize.width) {
      frameSize.width = screenSize.width;
    }
    win3.setLocation((screenSize.width - frameSize.width) / 2, (screenSize.height - frameSize.height) / 2);
    win3.setVisible(true);
]]></EventHandlingCode></Button>
<Button Flags="6" Brush="#cccccc" ID="61" Name="button2" Rect="-100 -230 -20 -200" Font="Tahoma,12" Label="Restart">
<EventHandlingCode><![CDATA[
Engine.restart();
/*parKolMasGSM = null;
parKolMasGPRS = null;
parReqData = null;*/
///timeGet.setValue(new Double(0));
//сброс массивов


//win2.tranGPRS.removeAllElements();
//exCfgSystem.tranGSM.removeAllElements();
//aiis.model.set_parKolMasGPRS(null);
//aiis.model.set_parKolMasGSM(null);

/*exCfgSystem.interKolGSM=0;
exCfgSystem.interKolGPRS=0;
    
exCfgSystem.jVsegoGSM.setText("0");
exCfgSystem.jVsegoGPRS.setText("0");

aiis.model.set_parVrMod(365*24);// установка длительности моделирования в значение по умолчанию (365 дней)

bRestart.setEnabled(false);    */
]]></EventHandlingCode></Button>
<Button Flags="6" Brush="#cccccc" ID="60" Name="button1" Rect="-200 -230 -120 -200" Font="Tahoma,12" Label="Pause">
<EventHandlingCode><![CDATA[Engine.stop();]]></EventHandlingCode></Button>
<Button Flags="6" Brush="#cccccc" ID="59" Name="button" Rect="-300 -230 -220 -200" Font="Tahoma,12" Label="Start">
<EventHandlingCode><![CDATA[Engine.run();]]></EventHandlingCode></Button>
<Button Flags="6" Brush="#cccccc" ID="51" Name="button5" Rect="-300 -180 -220 -150" Font="Tahoma,12" Label="Exit">
<EventHandlingCode><![CDATA[
//Engine.terminate();
Engine.restart();

]]></EventHandlingCode></Button>
<Button Flags="6" Brush="#cccccc" ID="49" Name="button4" Rect="-300 -280 -160 -250" Font="Tahoma,12" Label="System structure">
<EventHandlingCode><![CDATA[



cfgSystem win2 = new cfgSystem();
boolean packFrame = false;
  if (packFrame) {
      win2.pack();
    }
    else {
      win2.validate();
    }
    //Center the window
    Dimension screenSize = Toolkit.getDefaultToolkit().getScreenSize();
    Dimension frameSize = win2.getSize();
    if (frameSize.height > screenSize.height) {
      frameSize.height = screenSize.height;
    }
    if (frameSize.width > screenSize.width) {
      frameSize.width = screenSize.width;
    }
    win2.setLocation((screenSize.width - frameSize.width) / 2, (screenSize.height - frameSize.height) / 2);
   win2.setVisible(true);

                   
]]></EventHandlingCode></Button>
<Button Flags="6" Brush="#cccccc" ID="48" Name="button3" Rect="-140 -280 0 -250" Font="Tahoma,12" Label="GSM config">
<EventHandlingCode><![CDATA[


if (button3.isEnable())
{cfgGSM win1 = new cfgGSM();
boolean packFrame = false;
  if (packFrame) {
      win1.pack();
    }
    else {
      win1.validate();
    }
    //Center the window
    Dimension screenSize = Toolkit.getDefaultToolkit().getScreenSize();
    Dimension frameSize = win1.getSize();
    if (frameSize.height > screenSize.height) {
      frameSize.height = screenSize.height;
    }
    if (frameSize.width > screenSize.width) {
      frameSize.width = screenSize.width;
    }
    win1.setLocation((screenSize.width - frameSize.width) / 2, (screenSize.height - frameSize.height) / 2);
    win1.setVisible(true);

   // button3.setEnabled(false);
    }
//else if (button3.isEnable() == false){
//cfgGSM.getFrames().clone();

//}
]]></EventHandlingCode></Button>
<Text ID="90" Name="text7" Rect="10 -150 85.7 -132.9" Flags="28680" Pen="no 0" Brush="#000000" Font="Tahoma,12">
<Text><![CDATA[Time, hours]]></Text></Text>
<Text ID="88" Name="text9" Rect="10 -190 115.6 -172.9" Flags="28680" Pen="no 0" Brush="#000000" Font="Tahoma,12">
<Text><![CDATA[All gprs finished:]]></Text></Text>
<Text ID="89" Name="text10" Rect="10 -170 104.6 -152.9" Flags="28680" Pen="no 0" Brush="#000000" Font="Tahoma,12">
<Text><![CDATA[Kol finish gprs:]]></Text></Text>
<Text ID="87" Name="text6" Rect="10 -210 103.6 -192.9" Flags="28680" Pen="no 0" Brush="#000000" Font="Tahoma,12">
<Text><![CDATA[Kol finish gsm:]]></Text></Text>
<Text ID="86" Name="text5" Rect="10 -230 114.6 -212.9" Flags="28680" Pen="no 0" Brush="#000000" Font="Tahoma,12">
<Text><![CDATA[All gsm finished:]]></Text></Text>
<Text ID="82" Name="text4" Rect="120 -230 128.8 -213.6" Flags="28680" Pen="no 0" Brush="#000000" Font="Tahoma,12">
<TextExpr><![CDATA[model.finishAllGSM]]></TextExpr></Text>
<Text ID="81" Name="text3" Rect="120 -210 128.8 -193.6" Flags="28680" Pen="no 0" Brush="#000000" Font="Tahoma,12">
<TextExpr><![CDATA[model.kolFinishGSM]]></TextExpr></Text>
<Text ID="80" Name="text2" Rect="120 -190 128.8 -173.6" Flags="28680" Pen="no 0" Brush="#000000" Font="Tahoma,12">
<TextExpr><![CDATA[model.finishAllGPRS]]></TextExpr></Text>
<Text ID="79" Name="text1" Rect="120 -170 128.8 -153.6" Flags="28680" Pen="no 0" Brush="#000000" Font="Tahoma,12">
<TextExpr><![CDATA[model.kolFinishGPRS]]></TextExpr></Text>
<Text ID="58" Name="text" Rect="120 -150 128.8 -133.6" Flags="28680" Pen="no 0" Brush="#000000" Font="Tahoma,12">
<TextExpr><![CDATA[getTime()]]></TextExpr></Text>
</AnimationDiagram>
<SetupCode><![CDATA[//Engine.getAnimation().getToolbar().setVisible(false);]]></SetupCode>
<UpdateCode><![CDATA[//Engine.getAnimation().getToolbar().setVisible(false);]]></UpdateCode></Item>
</Animations>
<StructureDiagram>
<ChartTimer ID="2369" Name="timerCreate" Pos="170 -160" NamePos="180 -160" Type="1" Timeout="timeAsk-10">
<ExpiryAction><![CDATA[askCounter.fireEvent("createSystem");]]></ExpiryAction></ChartTimer>
<ChartTimer ID="1366" Name="timerResetModel" Pos="170 -180" NamePos="180 -179.9" Type="1" Timeout="1.0">
<ExpiryAction><![CDATA[
if (parKolMasGSM == null &  parKolMasGPRS == null & parKolMasRADIO == null)
Engine.restart();
]]></ExpiryAction></ChartTimer>
<ChartTimer ID="1259" Name="timerTimeEnd" Pos="50 -160" NamePos="60 -160" Type="2" Timeout="1">
<ExpiryAction><![CDATA[
if (parVrMod ==0)
{
Engine.stop();
collectionStat();

int n = JOptionPane.showConfirmDialog(Engine.getAnimation(),"Моделирование закончено. Вывести результаты на экран?","Внимание!!!",JOptionPane.YES_NO_CANCEL_OPTION,JOptionPane.QUESTION_MESSAGE);
switch(n){
case JOptionPane.YES_OPTION: outputResult();break;
case JOptionPane.NO_OPTION: break;
case JOptionPane.CANCEL_OPTION:
case JOptionPane.CLOSED_OPTION: break;
default:
}}
else{parVrMod--;}
]]></ExpiryAction></ChartTimer>
<ChartTimer ID="898" Name="timerStartAsk" Pos="50 -180" NamePos="60 -180" Type="2" Timeout="timeAsk">
<ExpiryAction><![CDATA[askCounter.fireEvent("Start");]]></ExpiryAction></ChartTimer>
<PortRef ID="2798" Name="portOut" Pos="250 -60" Parent="1749" OutCables="1883 1882" PrototypeID="1"/>
<PortRef ID="2799" Name="portIn" Pos="190 -60" Parent="1749" PrototypeID="2"/>
<PortRef ID="2800" Name="portOut" Pos="10 -60" Parent="1841" OutCables="1881 1880" PrototypeID="1"/>
<PortRef ID="2801" Name="portIn" Pos="-50 -60" Parent="1841" PrototypeID="2"/>
<PortRef ID="2802" Name="port" Pos="90 -100" Parent="1844" InCables="1880" PrototypeID="1"/>
<PortRef ID="2803" Name="port" Pos="90 -20" Parent="1846" InCables="1881" PrototypeID="1"/>
<PortRef ID="2804" Name="port" Pos="330 -100" Parent="1874" InCables="1882" PrototypeID="1"/>
<PortRef ID="2805" Name="port" Pos="330 -20" Parent="1876" InCables="1883" PrototypeID="1"/>
<Variable ID="2236" Name="timeScale" Pos="-60 -120" NamePos="-50 -120">
<VarType ScalarType="real"/>
<Value><![CDATA[60]]></Value>
<Equation/></Variable>
<Variable ID="2008" Name="statusOprosa" Pos="-60 -140" NamePos="-50 -140">
<VarType ScalarType="boolean"/>
<Value><![CDATA[false]]></Value>
<Equation/></Variable>
<Variable ID="957" Name="help" Pos="-60 -160" NamePos="-50 -160">
<VarType ScalarType="real"/>
<Equation Type="1" RightHandSide="0"/></Variable>
<Statechart ID="896" Name="askCounter" Pos="310 -180" NamePos="320 -180">
<Items>
<Initial ID="1" Name="pointer" Target="12" Points="-90 -660 -90 -570"/>
<Transition ID="14" Name="transition1" Source="13" Target="11" Points="-90 -500 -90 -450" Type="4">
<Trigger><![CDATA["Start"]]></Trigger></Transition>
<Transition ID="5" Name="transition12" Source="10" Target="13" Points="-230 -260 -310 -260 -310 -510 -140 -510" Type="1"/>
<Transition ID="6" Name="transition11" Source="9" Target="10" Points="-90 -340 -90 -270" Type="8">
<Trigger><![CDATA[finishAllGPRS==true & finishAllRADIO==true & finishAllGSM==true]]></Trigger></Transition>
<Transition ID="7" Name="transition6" Source="11" Target="9" Points="-90 -430 -90 -360" Type="1">
<Trigger><![CDATA[
gSM.finishGSM == true &
 //rADIO.finishRADIO == true &
gPRS.item(0).finishGPRS == true &
gPRS.item(1).finishGPRS == true
]]></Trigger></Transition>
<Transition ID="8" Name="transition" Source="12" Target="13" Points="-90 -550 -90 -520" Type="4">
<Trigger><![CDATA["createSystem"]]></Trigger></Transition>
<State ID="13" Name="Ожидание" Rect="-140 -520 -40 -500" NamePos="-120 -520" InCables="5 8" OutCables="14">
<Comment><![CDATA[Waiting]]></Comment>
<EntryAction><![CDATA[statusOprosa=randomTrue(0.5);]]></EntryAction></State>
<State ID="10" Name="Опрос по всем каналам закончен" Rect="-230 -270 50 -250" NamePos="-200 -270" InCables="6" OutCables="5">
<Comment><![CDATA[Polling over all channels is finished]]></Comment>
<EntryAction><![CDATA[
finishAllGPRS=false;
kolFinishGPRS=0; 

finishAllRADIO=false;
kolFinishRADIO=0; 

finishAllGSM=false;
kolFinishGSM=0; 

]]></EntryAction>
<ExitAction><![CDATA[


]]></ExitAction></State>
<State ID="11" Name="Начало опроса по всем каналам" Rect="-200 -450 20 -430" NamePos="-190 -450" InCables="14" OutCables="7">
<Comment><![CDATA[Begin polling through all channels]]></Comment>
<EntryAction><![CDATA[

 for (int q=0;q<3;q++)
{
   if (askChannel.get(0,q)==1 & q==1)
     {
      for (int i = 0; i<parKolMasGPRS.size()/2;i++)
          {
            //инициализация параметров каналов GPRS
            gPRS.item(i).set_maxKolSlotUP(parMaxKolSlotUP);
            gPRS.item(i).set_maxKolSlotDOWN(parMaxKolSlotDOWN);
            gPRS.item(i).set_typeCS(parCSforGPRS);

            gPRS.item(i).kolChannelBS=8*parKolFCh;
            gPRS.item(i).Ht=parHBS;
            gPRS.item(i).Hr=parHMS;
            gPRS.item(i).distance=parD;
            gPRS.item(i).maxMS=parMaxMS;
            gPRS.item(i).minMS=parMinMS;

            gPRS.item(i).powerBS=24;//дБм
            gPRS.item(i).gainBS=5;//дБи
            gPRS.item(i).gainMS=3;//дБи

            //инициализация параметров счётчиков СЭТ
            sETGPRS.item(i).set_maxTimeoutAnswer(parSETmaxTimeoutAnswer);
            sETGPRS.item(i).set_bitrate(parBitrateSET);
            sETGPRS.item(i).set_parReqData(parReqData);
            sETGPRS.item(i).set_verNoAnswer(parSETverNoAnswer);
            
            //инициализация параметров счётчиков МИР
            mIRGPRS.item(i).set_maxTimeoutAnswer(parMIRmaxTimeoutAnswer);
            mIRGPRS.item(i).set_parReqData(parReqData);
            mIRGPRS.item(i).set_bitrate(parBitrateMIR);
            mIRGPRS.item(i).set_verNoAnswer(parMIRverNoAnswer);
           
            if (statusOprosa)
            {
             mIRGPRS.item(i).oprosAlgoritm.fireEvent("startMIRGPRS");
            }
            else if (statusOprosa==false)
            {
             sETGPRS.item(i).oprosAlgoritm.fireEvent("startSETGPRS");
            }
          }
     }
   else if (askChannel.get(0,q)==0 & q==1)
     { 
      finishAllGPRS=true;
     }
   else if (askChannel.get(0,q)==1 & q==2)
     {
      for (int i = 0; i<parKolMasRADIO.size()/2;i++)
          {
           // rADIO.item(i).RADIO.fireEvent("startRADIO");
          }

     }
   else if (askChannel.get(0,q)==0 & q==2)
     { 
      finishAllRADIO=true;
     }

   else if (askChannel.get(0,q)==1 & q==0)
     { 
      for (int i = 0; i<parKolMasGSM.size()/2;i++)
          {
      //инициализация парметров канала GSM
      gSM.item(i).set_parVerUstGSM(parVerUstGSM);
      gSM.item(i).set_parVerEndGSM(parVerEndGSM);
      gSM.item(i).set_parVrUstGSM(parVrUstGSM);
      gSM.item(i).set_parVrEndGSM(parVrEndGSM);
   
      gSM.item(i).Ht=parHBSGSM;
      gSM.item(i).Hr=parHMSGSM;
      gSM.item(i).distance=parDGSM;

      gSM.item(i).powerBS=24;//дБм
      gSM.item(i).gainBS=5;//дБи
      gSM.item(i).gainMS=3;//дБи

      //инициализация параметров счётчиков СЭТ
      sETGSM.item(i).set_maxTimeoutAnswer(parSETmaxTimeoutAnswer);
      sETGSM.item(i).set_parReqData(parReqData);
      sETGSM.item(i).set_bitrate(parBitrateSET);
      sETGSM.item(i).set_verNoAnswer(parSETverNoAnswer);

      //инициализация параметров счётчиков МИР
      mIRGSM.item(i).set_maxTimeoutAnswer(parMIRmaxTimeoutAnswer);
      mIRGSM.item(i).set_bitrate(parBitrateMIR);
      mIRGSM.item(i).set_parReqData(parReqData);
      mIRGSM.item(i).set_verNoAnswer(parMIRverNoAnswer);
      
     // gSM.GSM.fireEvent("startGSM");
       if (statusOprosa)
            {
             mIRGSM.item(i).oprosAlgoritm.fireEvent("startMIRGSM");
            }
            else if (statusOprosa==false)
            {
            sETGSM.item(i).oprosAlgoritm.fireEvent("startSETGSM");
            }
}
     }
   else if (askChannel.get(0,q)==0 & q==0)
     { 
      finishAllGSM=true;
     }

}
 
 




]]></EntryAction>
<ExitAction><![CDATA[


]]></ExitAction></State>
<State ID="12" Name="Создание объектов" Rect="-150 -570 -30 -550" NamePos="-150 -570" InCables="1" OutCables="8">
<Comment><![CDATA[System's objects creation]]></Comment>
<ExitAction><![CDATA[

for (int q=0;q<3;q++)
{
 if (askChannel.get(0,q)==1 & q==1)
   {
    GPRSCreate(parKolMasGPRS.size()/2);//создание каналов GPRS
    MIRcreateForGPRS(parKolMasGPRS.size()/2);
    SETcreateForGPRS(parKolMasGPRS.size()/2);
   }  
 else if (askChannel.get(0,q)==1 & q==2)
   {
    //RADIOCreate(parKolMasRADIO.size()/2);//создание каналов RADIO
   }
 else if (askChannel.get(0,q)==1 & q==0)
   {
    GSMCreate(parKolMasGSM.size()/2);
    MIRcreateForGSM(parKolMasGSM.size()/2);
    SETcreateForGSM(parKolMasGSM.size()/2);
   }
 
}
]]></ExitAction></State>
<State ID="9" Name="Ожидания окончания опроса по всем каналам" Rect="-250 -360 60 -340" NamePos="-240 -360" InCables="7" OutCables="6">
<Comment><![CDATA[Waiting polling termination ]]></Comment>
<ExitAction><![CDATA[
 if (parKolMasGPRS!=null)
{
  for(int i=0;i<parKolMasGPRS.size()/2;i++)
{
 gPRS.item(i).VrOprosaGPRS.addElement(new Double(gPRS.item(i).currentTimeOpros));
 gPRS.item(i).currentTimeOpros=0;
  
 gPRS.item(i).avTimeSET.addElement(new Double(sETGPRS.item(i).avTimeSETGPRS/(((Double)parKolMasGPRS.get(2*i)).doubleValue()))); 
 sETGPRS.item(i).avTimeSETGPRS=0;

 gPRS.item(i).avTimeMIR.addElement(new Double(mIRGPRS.item(i).avTimeMIRGPRS/(((Double)parKolMasGPRS.get(2*i+1)).doubleValue()))); 
 mIRGPRS.item(i).avTimeMIRGPRS=0;
 }
 set_param(gPRS.item(0).VrOprosaGPRS);
}

 if (parKolMasGSM!=null)
{
    for(int i=0;i<parKolMasGSM.size()/2;i++)
 {
 gSM.item(i).vrUst.addElement(new Double(gSM.item(i).timeUstI));
  gSM.item(i).timeUstI=0;
  gSM.item(i).vrEnd.addElement(new Double(gSM.item(i).timeEndI));
  gSM.item(i).timeEndI=0;
 

   gSM.item(i).VrOprosaGSM.addElement(new Double(gSM.item(i).timeTransfer));
 gSM.item(i).timeTransfer=0;
 gSM.item(i).timeService=0;

 
 gSM.item(i).avTimeSET.addElement(new Double(sETGSM.item(i).avTimeSETGSM/(((Double)parKolMasGSM.get(2*i)).doubleValue()))); 
 sETGSM.item(i).avTimeSETGSM=0;

    gSM.item(i).avTimeMIR.addElement(new Double(mIRGSM.item(i).avTimeMIRGSM/(((Double)parKolMasGSM.get(2*i+1)).doubleValue()))); 
 mIRGSM.item(i).avTimeMIRGSM=0;
 }
}


]]></ExitAction></State>
</Items></Statechart>
<Connector ID="1883" Name="connector3" Source="2798" Target="2805" Points="250 -60 330 -20"/>
<Connector ID="1882" Name="connector2" Source="2798" Target="2804" Points="250 -60 330 -100"/>
<Connector ID="1881" Name="connector1" Source="2800" Target="2803" Points="10 -60 90 -20"/>
<Connector ID="1880" Name="connector" Source="2800" Target="2802" Points="10 -60 90 -100"/>
<Object OriginOffset="30.5 20.5" Flags="10" ID="1749" Name="gPRS" Pos="220 -60" NamePos="188.5 -91.5" Children="2798 2799" ReplicationFactor="0" Type="aiis.GPRS"/>
<Object OriginOffset="30.5 20.5" Flags="10" ID="1841" Name="gSM" Pos="-20 -60" NamePos="-51.5 -91.4" Children="2800 2801" ReplicationFactor="0" Type="aiis.GSM"/>
<Object OriginOffset="30.5 20.5" Flags="10" ID="1844" Name="mIRGSM" Pos="120 -100" NamePos="88.5 -131.5" Children="2802" ReplicationFactor="0" Type="aiis.MIRC01"/>
<Object OriginOffset="30.5 20.5" Flags="10" ID="1846" Name="sETGSM" Pos="120 -20" NamePos="88.5 -51.4" Children="2803" ReplicationFactor="0" Type="aiis.SET"/>
<Object OriginOffset="30.5 20.5" Flags="10" ID="1874" Name="mIRGPRS" Pos="360 -100" NamePos="328.5 -131.5" Children="2804" ReplicationFactor="0" Type="aiis.MIRC01"/>
<Object OriginOffset="30.5 20.5" Flags="10" ID="1876" Name="sETGPRS" Pos="360 -20" NamePos="328.5 -51.4" Children="2805" ReplicationFactor="0" Type="aiis.SET"/>
<Bounds Flags="0" Pen="#808080 20" Brush="#000000" ID="1" Name="model" Rect="-80 -200 410 20" NamePos="-70 -190"/>
<Comment ID="904" Name="textBox3" Rect="-80 -340 440 -240">
<Text><![CDATA[
все верменные интервалы указываются в секундах,с последующим переводом к нужному масштабу времени
1 ед.мод. времени=1час реального=3600с
"createSystem"
"createSystem"
"createSystem"


]]></Text></Comment>
</StructureDiagram>
<StartupCode><![CDATA[
//Engine.getAnimationFrame().setTitle("Отчётные графики");
//Engine.getAnimationFrame().setVisible(false);
//Engine.getAnimation().getToolbar().setVisible(false);
//startThread("testFun");
]]></StartupCode><Image/>
<Parameters>
<Item Name="parKolMasGSM" Type="Vector" Modificator="2"/>
<Item Name="parVerUstGSM" DefaultValue="90" Modificator="2"/>
<Item Name="parVerEndGSM" DefaultValue="1" Modificator="2"/>
<Item Name="parVrUstGSM" DefaultValue="15" Modificator="2"/>
<Item Name="parVrEndGSM" DefaultValue="3" Modificator="2"/>
<Item Name="parKolMasRADIO" Type="Vector" Modificator="2"/>
<Item Name="parVrModD" DefaultValue="365" Modificator="2"/>
<Item Name="parVrMod" DefaultValue="525600" Modificator="2"/>
<Item Name="parReqData" Type="Vector" Modificator="2"/>
<Item Name="parSETmaxTimeoutAnswer" DefaultValue="0.25" Modificator="2"/>
<Item Name="parSETverNoAnswer" DefaultValue="1" Modificator="2"/>
<Item Name="parMIRmaxTimeoutAnswer" DefaultValue="0.3" Modificator="2"/>
<Item Name="parMIRverNoAnswer" DefaultValue="1" Modificator="2"/>
<Item Name="parKolMasGPRS" Type="Vector" Modificator="2"/>
<Item Name="parCSforGPRS" Type="integer" DefaultValue="2" Modificator="2"/>
<Item Name="parMaxKolSlotUP" DefaultValue="2" Modificator="2"/>
<Item Name="parMaxKolSlotDOWN" DefaultValue="4" Modificator="2"/>
<Item Name="timeAsk" DefaultValue="24" Modificator="2"/>
<Item Name="parBitrateSET" DefaultValue="9600" Modificator="2"/>
<Item Name="parBitrateMIR" DefaultValue="9600" Modificator="2"/>
<Item Name="parKolFCh" DefaultValue="3" Modificator="2"/>
<Item Name="parHBS" DefaultValue="30" Modificator="2"/>
<Item Name="parHMS" DefaultValue="2" Modificator="2"/>
<Item Name="parD" DefaultValue="5" Modificator="2"/>
<Item Name="parMaxMS" DefaultValue="20" Modificator="2"/>
<Item Name="parMinMS" DefaultValue="1" Modificator="2"/>
<Item Name="parDGSM" DefaultValue="5" Modificator="2"/>
<Item Name="parHBSGSM" DefaultValue="30" Modificator="2"/>
<Item Name="parHMSGSM" DefaultValue="2" Modificator="2"/>
<Item Name="param" Type="Vector" DefaultValue="null" Modificator="2"/>
</Parameters></Item>
</ActiveObjectClasses></Item>
<Item Name="interfaceMod" Expanded="y">
<ExternalFiles>
<Item Name="cfgGSM.java" RelativePathName="cfgGSM.java"/>
<Item Name="cfgSystem.java" RelativePathName="cfgSystem.java"/>
<Item Name="dcfgMod.java" RelativePathName="dcfgMod.java"/>
</ExternalFiles></Item>
</Packages></Item>
</Projects>
<Experiments>
<SimulationExperiments>
<Item Name="Simulation" StopAtTime="0" Time="0" RootObject="aiis.model" Current="1">
<Desktop xmlns:dt="urn:schemas-microsoft-com:datatypes" dt:dt="bin.base64">
AAAAAE0FAAABAAAABwAAAM8AAAABAAAAAQAAAP//AAASAENYSk1ESU1vbm9DaGlsZFduZAAA
AAAAAAAAAQAAAJQBAAD//wAAFABDTW9kZWxTdGF0ZWNoYXJ0VmlldwMAAAAbcm9vdC5zRVRH
U00tMC5vcHJvc0FsZ29yaXRtAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAA
AAAAAQAAAP//////////+v///+D///9sAgAAIgEAALwDAADNAgAAAwAAAAAAKwAAAAAAAAAA
AAAAAAAAAAAAAADPAAAAAQAAAAEAAAD//wAAEgBDWEpNRElNb25vQ2hpbGRXbmQAAAAAAAAA
AAEAAACUAQAA//8AABQAQ01vZGVsU3RhdGVjaGFydFZpZXcDAAAAG3Jvb3QubUlSR1NNLTAu
b3Byb3NBbGdvcml0bQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAEA
AAD///////////r////g////9AAAACMBAABLAgAAxgIAAAMAAAAAAC8AAAAAAAAAAAAAAAAA
AAAAAAAAwwAAAAEAAAABAAAA//8AABIAQ1hKTURJTW9ub0NoaWxkV25kAAAAAAAAAAABAAAA
lAEAAP//AAAUAENNb2RlbFN0YXRlY2hhcnRWaWV3AwAAAA9yb290LmFza0NvdW50ZXIAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAAAAAABAAAA///////////6////4P//
/+kCAAAEAAAA1gMAAB8BAAADAAAAAABEAAAAAAAAAAAAAAAAAAAAAAAAAMQAAAABAAAAAQAA
AP//AAASAENYSk1ESU1vbm9DaGlsZFduZAAAAAAAAAAAAQAAAJQBAAD//wAAFABDTW9kZWxT
dGF0ZWNoYXJ0VmlldwMAAAAQcm9vdC5nUFJTLTAuR1BSUwAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAsAAAAAAAAAAEAAAD///////////r////g////3wMAAAQAAADyBAAAdQEA
AAMAAAAAAFEAAAAAAAAAAAAAAAAAAAAAAAAAxgAAAAEAAAABAAAA//8AABIAQ1hKTURJTW9u
b0NoaWxkV25kAAAAAAAAAAABAAAAlAEAAP//AAAUAENNb2RlbFN0YXRlY2hhcnRWaWV3AwAA
AA5yb290LmdTTS0wLkdTTQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAAAAAA
AAEAAAD///////////r////g////3QMAAH4BAAD1BAAA1QIAAAMAAAABAG4AAABBAAAAAAAA
AAAAAAAAAAAAAAAAAKAAAAABAAAAAQAAAP//AAASAENYSk1ESU1vbm9DaGlsZFduZAAAAAAA
AAAAAQAAALsBAAD//wAADgBDQW5pbWF0aW9uVmlldwMAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAACwAAAAAAAAAAQAAAP//////////+v///+D////1AAAAAgAAAOcCAAAe
AQAAAQAAAGQAAAAAAAAAngAAAAEAAAABAAAA//8AABIAQ1hKTURJTW9ub0NoaWxkV25kAAAA
AAAAAAABAAAAkgEAAP//AAAQAENNb2RlbE9iamVjdFZpZXcDAAAABHJvb3QAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAAAAAABAAAA///////////6////4P///wMAAAAB
AAAA8QAAAA0DAAAAAAAA</Desktop></Item>
</SimulationExperiments></Experiments>
<AnimatonSettings/>
<EditorDesktop xmlns:dt="urn:schemas-microsoft-com:datatypes" dt:dt="bin.base64">
AAAAAOwEAAABAAAABgAAAL8AAAABAAAAAQAAAP//AAASAENYSk1ESU1vbm9DaGlsZFduZAAA
AAAAAAAAAQAAALIBAAD//wAACQBDQ29kZVZpZXcDAAAAGFxQcm9qZWN0c1xBSUlTXGFpaXNc
R1BSUwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAMAAAD/////////
//r////g////hAAAAK4AAAAIBAAA2QIAAAEAAAABAAAAAQAAAAAAAAABAAAAAAAAAMkAAAAB
AAAAAQAAAP//AAASAENYSk1ESU1vbm9DaGlsZFduZAAAAAAAAAAAAQAAALIBAAD//wAACQBD
Q29kZVZpZXcDAAAAIlxQcm9qZWN0c1xBSUlTXGFpaXNcbW9kZWxcbW9kZWxpbmcAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAAAAAADAAAA///////////6////4P///5oA
AADLAAAAGAQAANcCAAABAAAAAQAAAAEAAAAAAAAAAQAAAAAAAADAAAAAAQAAAAEAAAD//wAA
EgBDWEpNRElNb25vQ2hpbGRXbmQAAAAAAAAAAAEAAACyAQAA//8AAAkAQ0NvZGVWaWV3AwAA
ABlcUHJvamVjdHNcQUlJU1xhaWlzXG1vZGVsAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAACwAAAAAAAAAAwAAAP//////////+v///+D///+wAAAA6AAAAC4EAAD0AgAAAQAAAAEA
AAABAAAAAAAAAIAAAAAAAAAA1wAAAAEAAAABAAAA//8AABIAQ1hKTURJTW9ub0NoaWxkV25k
AAAAAAAAAAABAAAAigEAAP//AAAVAENBbmltYXRpb25EaWFncmFtVmlldwMAAAAiXFByb2pl
Y3RzXEFJSVNcYWlpc1xtb2RlbFxtb2RlbGluZwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAsAAAAAAAAAAMAAAD///////////r////g////xgAAAAUBAABEBAAAEQMAAAMAAAAA
AGQAAAAkAwAAmgMAAAAAAAAAAAAA2gAAAAEAAAABAAAA//8AABIAQ1hKTURJTW9ub0NoaWxk
V25kAAAAAAAAAAABAAAAiAEAAP//AAAWAENTdGF0ZWNoYXJ0RGlhZ3JhbVZpZXcDAAAAJFxQ
cm9qZWN0c1xBSUlTXGFpaXNcbW9kZWxcYXNrQ291bnRlcgAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAsAAAAAAAAAAMAAAD///////////r////g////AAAAAAAAAAB+AwAADAIA
AAMAAAAAAGQAAAD+AgAAugIAAAAAAAAAAAAA0wAAAAEAAAABAAAA//8AABIAQ1hKTURJTW9u
b0NoaWxkV25kAAAAAAAAAAABAAAAiAEAAP//AAAWAENTdGF0ZWNoYXJ0RGlhZ3JhbVZpZXcD
AAAAHVxQcm9qZWN0c1xBSUlTXGFpaXNcR1BSU1xHUFJTAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAACwAAAACAAAAAwAAAP//////////+v///+D///8WAAAAHQAAANMBAAApAgAA
AwAAAAAAZAAAAMsDAACkAwAAAAAAAAAAAAA=</EditorDesktop>
<ControlBars>
<Editor PropertiesBarState="6"/>
<Viewer ProjectBarState="0" StencilsBarState="0" PropertiesBarState="6"/></ControlBars>
</AnyLogicWorkspace>
